<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>why&#8217;s (poignant) guide to ruby :: 6. Downtown</title>
    <link rel="stylesheet" type="text/css" href="../guide.css" />
</head>
<body class="chapter">

<div id="banner">
   <div class="pager">
   <a class="pagebar" href="chapter-5.html">previous</a> | <a class="pagebar" href="chapter-7.html">next</a>
   </div>
   <div class="title">
   <img src="../images/2006.chaptertitle.png" alt="why's (poignant) guide to ruby" />
   </div>
</div>
<div id="container">
<div class="page">
    <div class="pageLinks">
        <a class="pagebar" href="http://whytheluckystiff.net/">whytheluckystiff.net</a> | <a class="pagebar" href="./">Contents</a>
    </div>
    <div class="pageTitle">
        
            <h3>6.</h3>
            <h1>Downtown</h1>
            <p><img src="../images/chapter.poignant.guide-6.jpg" alt="[o]" /></p>
        
    </div>
    <div class="content">

    

        <p><img src="../images/wixl-1.jpg" title="Lost in Wixl" alt="Lost in Wixl" />
<img src="../images/wixl-2.gif" title="This heist goes all the way up?" alt="This heist goes all the way up?" /></p>


	<p>Oblivious to their involvement in the expansive plan of The Originals, both the tall fox and the much shorter fox had wandered right into the red alert zone, the city Wixl.  I desire a spatula to scoop them aside with, shuffle them off to the coast near the beach hatcheries, hide them in piles of fish eggs, hold down their pointy ears, concealing their luxurious hides.  And above them I would stand, casting an unmoving shadow, holding my rifle aloof.</p>


	<p>I can&#8217;t.  I have you to teach.  I have to groom and care for myself.  The lightbulbs upstairs need changing.  A free pack of halogen lightbulbs just showed up out of the mail.  Somebody out there is obviously trying to get me to use them.  So I&#8217;m going to screw &#8216;em in.  And just stand there, casting an unmoving shadow, holding my rifle aloof.</p>


	<p>Should that shadow be nice and defined, then I&#8217;ll keep &#8216;em.</p>

    
    
        
        <a name="section1" />
        <h2>1. If I Were Looking For a Vehicle</h2>

        <p><img src="../images/wixl-7.gif" title="Sitting for a moment." alt="Sitting for a moment." /></p>


	<p>I like seeing these two out in the wild.  They got pretty bored here in the studio.  They started making up wierd slogans and stuff.  They had some phrase they kept repeating, forming fixations upon. You can&#8217;t be exposed to all that contrived fox nonsense.</p>


	<p>Let&#8217;s just say: I am really trying my best to keep things collegiate.  Having never attended college, I can&#8217;t well say if every passage written chimes right with the stringent criteria which academia demands. I have university friends aplenty, some who tour the globe in their pursuits, and I try to inflect my voice with just their blend of high culture.</p>


	<p>Sometimes I applaud myself for going beyond the work of my educated friends <del>- only in quiet corridors, we never butt heads publicly -</del> because <em>I have actually subscribed</em> to a school of thought while they are still in their books, turning and turning.</p>


	<p><strong>I am a preeventualist.</strong>  I have dabbled in it long enough and am glad to come forth with it. Inevitably, some of you have already started mining this book for Marxist symbology.  I am sad to kill those interpretations, but I believe any nihilist conclusions you&#8217;ve drawn will still hold up under scrutiny.</p>


	<p>Anyway, I&#8217;ll drop the rhetoric.  I only mention preeventualism because, aside from being a refreshing and easy alternative to the post-modernism we&#8217;re born with, <em>this</em> meta-cult offers a free lost-and-found service for the residents of Wixl.</p>


<div class='example'><pre><code> <span class="ident">require</span> <span class="punct">'</span><span class="string">open-uri</span><span class="punct">'</span>
 <span class="ident">open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">http://preeventualist.org/lost</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">lost</span><span class="punct">|</span>
   <span class="ident">puts</span> <span class="ident">lost</span><span class="punct">.</span><span class="ident">read</span>
 <span class="keyword">end</span></code></pre></div>

	<p>I have no way of alerting the foxes to this service.  And I&#8217;m sure it&#8217;s too soon for their truck to be listed. Still, the good intentions are here.</p>


	<p>If you&#8217;re connected to the Internet, the above Ruby should have downloaded the web page from the Internet and printed it to the screen.  In a message resembling this:</p>


<div class='example'><pre class="text">                   THE PREEVENTUALIST'S LOSING AND FINDING REGISTRY
          (a free service benefiting the ENLIGHTENED who have been LIGHTENED)

                                      ---
                      updates are made daily, please check back!
                                      ---

                         this service is commissioned and
                     subsidized in part by The Ashley Raymond
                                Youth Study Clan

                                      ...
                      all seals and privileges have been filed
                under the notable authorship of Perry W. L. Von Frowling,
          Magistrate Polywaif of Dispossession.  Also, Seventh Straight Winner
                   of the esteemed Persistent Beggar's Community Cup.
                                      ...

  ABOUT THE REGISTRY
  ==================
  Hello, if you are new, please stay with us.  A brief explanation of our service will 
  follow.  First, a bit of important news from our beloved magistrate.  (The kids call
  him Uncle Von Guffuncle. Tehe!)

  IMPORTANT NEWS
  ==============
  / 15 April 2005 /
  hi, big news.  we were on channel 8 in wixl and ordish.  cory saw it.  i was on and 
  jerry mathers was on.  if you didn't see it, e-mail cory.  he tells it the best.  all 
  i can say is those aren't MY hand motions!! (joke for people who watch channel 8.)  
  thanks harry and whole channel 8 news team!!
                                                   - perry

  / 07 April 2005 /
  we're all sifting through the carpet here at hq, but if you could all keep an eye out 
  for caitlin's clipboard, she's too quiet of a gal to post it and i know that it's 
  REALLY important to her.  she had a few really expensive panoramic radiographs of her 
  husband's underbite clipped to a few irreplacable photos of her husband in a robocop 
  costume back when the underbite was more prominent.  she says (to me), "they'll know
  what i mean when they see them."  i don't know what that means.  :(

  i've checked: * the front desk * the hall * the waiting area * the bathroom * the candy 
  closet * the big tv area * the lunch counter * the disciples room * gaff's old room
  (the one with the painting of the cherry tree) * the server room * staircase.  i'll 
  update this as i find more rooms.
                                                   - love, perry

  / 25 Feb 2005 /
  server went down at 3 o'clock.  i'm mad as you guys.  gaff is downstairs and he'll 
  be down there until he gets it fixed. :O -- UPDATE: it's fixed, back in bizz!!
                                                   - perry

  / 23 Feb 2005 /
  i know there's a lot of noise today.  stanley bros circus lost twelve llamas and a
  trailer and a bunch of Masterlocks and five tents.  they're still finding lost stuff.
  pls keep your heads, i need everyone's help.  these entertainers have _nothing_.  i 
  mean it.  i gave a guy a purple sticker today (it's just something i like to do as a
  kind gesture) and he practically slept on it and farmed the ingredients for pizza sauce
  on it.  they are on rock bottom.

  so please donate.  i know we don't have paypal or anything.  so if you want to donate,
  just post that you found something (a children's bike, a month of perishable canned 
  goods) and that it has the circus people's names written on it or something.
                                                   - great, perry

  / 15 Nov 2004 /
  preeventualist's day sale.  if you lose something today, you get to pick one free 
  item (of $40 value or less) from the house of somebody who found something.  we're 
  having so much fun with this!!  this is EXACTLY how i got my rowing machine last year
  and i LOVE IT!!
                                                   - perry
</pre></div>

	<p>I think the Youth Study Clan is doing a great job with this service.  It&#8217;s a little hokey and threadbare, but if it can get animals to stop using their instinctive means of declaring ownership, then hats off.</p>


	<p>Still, a preeventualist youth group?  How can that be?  You&#8217;ve got to at least <em>flirted with real cynicism</em> before you can become a preeventualist.  And you definitely can&#8217;t attend school. So, I don&#8217;t know.</p>


	<p>Going back to the list of instructions from the Preeventualist&#8217;s Losing and Finding Registry.</p>


<div class='example'><pre class="text"> USING THE L&#38;F SERVER
 ====================
 The L&#38;F is a free service.  The acts of losing and finding are essential qualities in
 building a preeventualist lifestyle.  We hope to accomodate your belief.

 We do not use HTML, in order to simplify our work here.  Our guys are already working
 fifteen hour days.  (Thanks, Terk!!  Thanks, Horace!!)

 You may search our service for your lost items.  Or you may add your lost (or found)
 item to our registry.  This is done by typing the proper address into your browser.

 SEARCHING
 =========
 To search for lost items, use the following address:

   http://preeventualist.org/lost/search?q={search word}

 You may replace {search word} with your search term.  For example, to search for "cup":

   http://preeventualist.org/lost/search?q=cup

 You will be given a list of cups which have been lost or found.

 If you want to search for only lost cups or only found cups, use the `searchlost' and
 `searchfound' pages:

   http://preeventualist.org/lost/searchlost?q=cup
</pre></div>

	<p>I&#8217;m not playing games.  I know where the truck is.  Really, I&#8217;m not teasing you.  I&#8217;ll  show you in just a sec.  I&#8217;m just saying, look at the foxes:</p>


	<p><img src="../images/wixl-11.gif" title="Hummmmm." alt="Hummmmm." /></p>


	<p>They are helpless.  And yet, here is this great tool.  A possible key to getting out of this mess. I just want to poke around, see if there are any clues here.</p>


<div class='example'><pre><code> <span class="ident">require</span> <span class="punct">'</span><span class="string">open-uri</span><span class="punct">'</span>

 <span class="comment"># Searching all found items containing the word `truck'.</span>
 <span class="ident">open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">http://preeventualist.org/lost/searchfound?q=truck</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">truck</span><span class="punct">|</span>
   <span class="ident">puts</span> <span class="ident">truck</span><span class="punct">.</span><span class="ident">read</span>
 <span class="keyword">end</span></code></pre></div>

	<p>I&#8217;m not seeing anything about the tall fox&#8217;s truck in this list.  That&#8217;s okay. The foxes are out of it anyway.  We have some time.</p>


	<p>You&#8217;ve learned a very simple technique for retrieving a web page from the Internet.  The code uses the <code><span class="constant">OpenURI</span></code> library, which was written by one of my favorite Rubyists, Akira Tanaka.  He&#8217;s simplified reading from the Internet so that it&#8217;s identical to reading a file from your computer.</p>


	<p>In a previous chapter, we stored your diabolical ideas in a text file.  You read these files in Ruby using <code><span class="ident">open</span></code>.</p>


<div class='example'><pre><code> <span class="ident">require</span> <span class="punct">'</span><span class="string">open-uri</span><span class="punct">'</span>

 <span class="comment"># Opening an idea file from a folder on your computer.</span>
 <span class="ident">open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">folder/idea-about-hiding-lettuce-in-the-church-chairs.txt</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">idea</span><span class="punct">|</span>
   <span class="ident">puts</span> <span class="ident">idea</span><span class="punct">.</span><span class="ident">read</span>
 <span class="keyword">end</span></code></pre></div>

	<p>Files are <strong>input-output objects</strong>.  You can read and write to a file.  In Ruby, all IO (input-output) objects have <code><span class="ident">read</span></code> and <code><span class="ident">write</span></code> methods.  The <code><span class="ident">open</span></code> method slides an IO object <strong>down the chute</strong> into a block for your use.  IO is your ticket to the outside world.  It&#8217;s the rays of sunlight cast through the prison bars.  (However, you can&#8217;t <code><span class="ident">write</span></code> to a web page with <code><span class="constant">OpenURI</span></code>.  You&#8217;ll need to find a tool for copying to your web server.  An <span class="caps">FTP</span> program, for instance.)</p>


	<p>If someone wants to read your diabolical idea about hiding lettuce in the church chairs, assuming you&#8217;ve posted it as a web page:</p>


<div class='example'><pre><code> <span class="ident">require</span> <span class="punct">'</span><span class="string">open-uri</span><span class="punct">'</span>

 <span class="comment"># Opening an idea file available on a web site.</span>
 <span class="ident">open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">http://your.com/idea-about-hiding-lettuce-in-the-church-chairs.txt</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">idea</span><span class="punct">|</span>
   <span class="ident">puts</span> <span class="ident">idea</span><span class="punct">.</span><span class="ident">read</span>
 <span class="keyword">end</span></code></pre></div>

	<p>The <code><span class="constant">OpenURI</span></code> library also understands <span class="caps">FTP</span> addresses as well.  This widens the possibilities for where you can store files.  On your system or elsewhere on the Internet.</p>


	<h3>Reading Files Line by Line</h3>


	<p>When you&#8217;re using <code><span class="constant">OpenURI</span></code> to get information from the web with the <code><span class="ident">open</span></code> and <code><span class="ident">read</span></code> methods, the page is given to you as a <code><span class="constant">String</span></code>.  You can also read the page one line at a time, if you&#8217;re searching for something.  Or if the page is big and you want to conserve your computer&#8217;s memory.</p>


<div class='example'><pre><code> <span class="ident">require</span> <span class="punct">'</span><span class="string">open-uri</span><span class="punct">'</span>
 <span class="ident">open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">http://preeventualist.org/lost/searchfound?q=truck</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">truck</span><span class="punct">|</span>
   <span class="ident">truck</span><span class="punct">.</span><span class="ident">each_line</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">line</span><span class="punct">|</span>
     <span class="ident">puts</span> <span class="ident">line</span> <span class="keyword">if</span> <span class="ident">line</span><span class="punct">['</span><span class="string">pickup</span><span class="punct">']</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>The above code will retrieve the list of trucks found by preeventualists, then display only those lines that actually contain the word &#8216;pickup&#8217;. That way we can trim out the descriptions and look for only the pertinent lines.</p>


	<p>Above, the <strong>index brackets</strong> are used on a string, so the string is searched for whatever is inside the brackets.  Since the string <code><span class="punct">'</span><span class="string">pickup</span><span class="punct">'</span></code> is inside the brackets, the <code><span class="ident">line</span></code> string is searched for the word &#8220;pickup&#8221;.</p>


	<p><img src="../images/wixl-13.gif" title="On being funny." alt="On being funny." /></p>


	<p>When a web page is loaded with <code><span class="ident">read</span></code>, the entire page is loaded into memory.  Usually this only takes up a few thousand bytes.  But if a page is big (several megabytes), you&#8217;ll probably want to use <code><span class="ident">each_line</span></code>, which loads one line at a time to avoid exhausting memory.</p>


	<h3>Yielding is Kiddie Blocks</h3>


	<p>Ruby often uses iterators in this fashion.  Yes, iterators are used for cycling through each item in a collection of items, such as an array or hash.  Now look at an IO source as a collection of lines.  The iterator can crawl that collection of lines.</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">IO</span>
   <span class="comment"># Definition for the each_line method.  Notice how it has no</span>
   <span class="comment"># argument list.  Blocks don't need to be listed as arguments.</span>
   <span class="keyword">def </span><span class="method">each_line</span>
     <span class="keyword">until</span> <span class="ident">eof?</span>        <span class="comment"># until we reach the end of the file...</span>
       <span class="keyword">yield</span> <span class="ident">readline</span>  <span class="comment"># pass a line into the block</span>
     <span class="keyword">end</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>The <code><span class="keyword">yield</span></code> keyword is the easiest way to use a block.  One word.  Just like a curtain has a pullstring or like a suitcase has a handle.  Inside a method, you can press the blinking <code><span class="keyword">yield</span></code> button and it will run the block attached to that method.  Glowing a strong red color until the code inside the block is done.  And then it goes back to blinking and you can press the button again if you like.</p>


<div class='example'><pre><code> <span class="keyword">def </span><span class="method">yield_thrice</span>
   <span class="keyword">yield</span>
   <span class="keyword">yield</span>
   <span class="keyword">yield</span>
 <span class="keyword">end</span></code></pre></div>

	<p>Punch the <code><span class="keyword">yield</span></code> button three times quick and the block gets to live its life three times.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">a</span> <span class="punct">=</span> <span class="punct">['</span><span class="string">first, birth.</span><span class="punct">',</span> <span class="punct">'</span><span class="string">then, a life of flickering images.</span><span class="punct">',</span> <span class="punct">'</span><span class="string">and, finally, the end.</span><span class="punct">']</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">yield_thrice</span> <span class="punct">{</span> <span class="ident">puts</span> <span class="ident">a</span><span class="punct">.</span><span class="ident">shift</span> <span class="punct">}</span>
 <span class="comment"># prints out:</span>
 <span class="comment">#   first, birth.</span>
 <span class="comment">#   then, a life of flickering images.</span>
 <span class="comment">#   and, finally, the end.</span></code></pre></div>

	<p>The <code><span class="ident">shift</span></code> method pulls the first item off an array.  The barber <code><span class="ident">shift</span></code> cuts the hair off and hands it over.  Then, the scalp.  And just keeps going, whittling the poor guy down to nothing.</p>


	<p>You&#8217;ve seen blocks attached to methods.  Any Ruby method can have block attached to the end.</p>


<div class='example'><pre><code> <span class="comment"># The brief style of attaching a block to a method.</span>
 <span class="comment"># Here the block is surrounded with curly braces.</span>
 <span class="ident">open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">idea.txt</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">f</span><span class="punct">|</span> <span class="ident">f</span><span class="punct">.</span><span class="ident">read</span> <span class="punct">}</span>

 <span class="comment"># The verbose style of attaching a block to a method.</span>
 <span class="comment"># Here the block is surrounded with `do' and `end'</span>
 <span class="ident">open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">idea.txt</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">f</span><span class="punct">|</span>
   <span class="ident">f</span><span class="punct">.</span><span class="ident">read</span>
 <span class="keyword">end</span></code></pre></div>

	<p>If you pass arguments to <code><span class="keyword">yield</span></code>, those arguments will also be passed to the block. The block is riding in a little sidecar attached to the method&#8217;s motorcycle.  The method yells out a list arguments, screaming to the block over all the wind as they&#8217;re racing through the desert.  The block taps his helmet like, &#8220;I get it, my brain gets it.&#8221;</p>


<div class='example'><pre><code> <span class="comment"># The method opens two files and slides the resulting IO objects down the</span>
 <span class="comment"># chute to an attached block.</span>
 <span class="keyword">def </span><span class="method">double_open</span> <span class="ident">filename1</span><span class="punct">,</span> <span class="ident">filename2</span>
   <span class="ident">open</span><span class="punct">(</span> <span class="ident">filename1</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">f1</span><span class="punct">|</span>
     <span class="ident">open</span><span class="punct">(</span> <span class="ident">filename2</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">f2</span><span class="punct">|</span>
       <span class="keyword">yield</span> <span class="ident">f1</span><span class="punct">,</span> <span class="ident">f2</span>
     <span class="keyword">end</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span>

 <span class="comment"># Prints the files out side-by-side.</span>
 <span class="ident">double_open</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">idea1.txt</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">idea2.txt</span><span class="punct">&quot;</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">f1</span><span class="punct">,</span> <span class="ident">f2</span><span class="punct">|</span>
   <span class="ident">puts</span> <span class="ident">f1</span><span class="punct">.</span><span class="ident">readline</span> <span class="punct">+</span> <span class="punct">&quot;</span><span class="string"> | </span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">f2</span><span class="punct">.</span><span class="ident">readline</span>
 <span class="keyword">end</span></code></pre></div>

	<p>You may also wonder what the <code><span class="keyword">yield</span></code> keyword has to do with street signs.  And really, it&#8217;s a good question with, I believe, a good answer.  When you run a method, you are giving that method control of your program.  Control to do its job and then come back to with an answer.</p>


	<p>With <code><span class="keyword">yield</span></code>, the method is stopping at the intersection, giving control back to you, to your block.  The method is letting you do your work before resuming its work.  So while the <code><span class="ident">each_line</span></code> method does the work of actually reading lines from a file, the <strong>block attached to the <code><span class="ident">each_line</span></code> method</strong> is handed the line itself and gets a chance to hammer away at it in the sidecar.</p>


	<h3>Preeventualism in a Gilded Box</h3>


	<p>You&#8217;ve learned so much about <code><span class="constant">OpenURI</span></code> and using <code><span class="keyword">yield</span></code> to write your own iterators. You know your way around the lost-and-found service.  Really, you can starting hunting through the Wixl junk drawer without me.</p>


	<p>Let&#8217;s neatly <em>encapsulate</em> the entire service into a single class.</p>


<div class='example'><pre><code> <span class="ident">require</span> <span class="punct">'</span><span class="string">open-uri</span><span class="punct">'</span>
 <span class="keyword">module </span><span class="module">PreEventualist</span>
   <span class="keyword">def </span><span class="method">self.open</span> <span class="ident">page</span><span class="punct">,</span> <span class="ident">query</span>
     <span class="ident">qs</span> <span class="punct">=</span> 
       <span class="ident">query</span><span class="punct">.</span><span class="ident">map</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">k</span><span class="punct">,</span> <span class="ident">v</span><span class="punct">|</span>
         <span class="constant">URI</span><span class="punct">.</span><span class="ident">escape</span> <span class="punct">&quot;</span><span class="string"><span class="expr">#{ k }</span>=<span class="expr">#{ v }</span></span><span class="punct">&quot;</span> 
       <span class="keyword">end</span><span class="punct">.</span><span class="ident">join</span> <span class="punct">&quot;</span><span class="string">&amp;</span><span class="punct">&quot;</span> 
     <span class="constant">URI</span><span class="punct">.</span><span class="ident">parse</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">http://preeventualist.org/lost/</span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">page</span> <span class="punct">+</span> <span class="punct">&quot;</span><span class="string">?</span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">qs</span> <span class="punct">).</span><span class="ident">open</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">lost</span><span class="punct">|</span>
       <span class="ident">lost</span><span class="punct">.</span><span class="ident">read</span><span class="punct">.</span><span class="ident">split</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">--<span class="escape">\n</span></span><span class="punct">&quot;</span> <span class="punct">)</span>
     <span class="keyword">end</span>
   <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">self.search</span> <span class="ident">word</span>
     <span class="ident">open</span> <span class="punct">&quot;</span><span class="string">search</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">q</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">word</span>
   <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">self.searchlost</span> <span class="ident">word</span>
     <span class="ident">open</span> <span class="punct">&quot;</span><span class="string">searchlost</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">q</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">word</span>
   <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">self.searchfound</span> <span class="ident">word</span>
     <span class="ident">open</span> <span class="punct">&quot;</span><span class="string">searchfound</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">q</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">word</span>
   <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">self.addfound</span> <span class="ident">your_name</span><span class="punct">,</span> <span class="ident">item_lost</span><span class="punct">,</span> <span class="ident">found_at</span><span class="punct">,</span> <span class="ident">description</span>
     <span class="ident">open</span> <span class="punct">&quot;</span><span class="string">addfound</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">name</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">your_name</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">item</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">item_lost</span><span class="punct">,</span> 
                      <span class="punct">&quot;</span><span class="string">at</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">found_at</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">desc</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">description</span>
   <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">self.addlost</span> <span class="ident">your_name</span><span class="punct">,</span> <span class="ident">item_found</span><span class="punct">,</span> <span class="ident">last_seen</span><span class="punct">,</span> <span class="ident">description</span>
     <span class="ident">open</span> <span class="punct">&quot;</span><span class="string">addlost</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">name</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">your_name</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">item</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">item_found</span><span class="punct">,</span>
                     <span class="punct">&quot;</span><span class="string">seen</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">last_seen</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">desc</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="ident">description</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>At some point with your code, you need to start shaping it into something neat.  Save the above module in a file called <code><span class="ident">preeventualist</span><span class="punct">.</span><span class="ident">rb</span></code>.</p>


	<p>This module is a very simple library for using the Preeventualist&#8217;s service.  This is exactly the way libraries are written.  You whip up a module or a class, store it in a file, and, if you&#8217;re happy with it and want the world to benefit, put it on the web.</p>


	<p>These stragglers can you use your module just like I used <code><span class="constant">OpenURI</span></code> earlier.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">require</span> <span class="punct">'</span><span class="string">preeventualist</span><span class="punct">'</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">puts</span> <span class="constant">PreEventualist</span><span class="punct">.</span><span class="ident">search</span><span class="punct">(</span> <span class="punct">'</span><span class="string">truck</span><span class="punct">'</span> <span class="punct">)</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">puts</span> <span class="constant">PreEventualist</span><span class="punct">.</span><span class="ident">addfound</span><span class="punct">(</span> <span class="punct">'</span><span class="string">Why</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Ruby skills</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Wixl park</span><span class="punct">',</span>
        <span class="punct">&quot;</span><span class="string">I can give you Ruby skills!<span class="escape">\n</span>Come visit poignantguide.net!</span><span class="punct">&quot;</span> <span class="punct">)</span></code></pre></div>

    
    
        
        <a name="section2" />
        <h2>2. Meanwhile, The Porcupine Stops To Fill-Up</h2>

        <p><img src="../images/porcupine-1.gif" title="The porcupine pays for gas.  Kites?" alt="The porcupine pays for gas.  Kites?" /></p>

    
    
        
        <a name="section3" />
        <h2>3. A Sponsored Dragon-Slaying</h2>

        <p><img src="../images/wixl.dwemthy-1.gif" title="The slayer hops in." alt="The slayer hops in." /></p>


	<p>&#8220;Look around,&#8221; said Fox Small.  &#8220;Some of us don&#8217;t have time for quests.  Some of us have major responsibilities, jobs, so on.   Livelihood, got it?&#8221;</p>


	<p>&#8220;<em>Heyyyy</em>, my <strong><span class="caps">JOB</span></strong> was to kill the drgn!!&#8221; screamed the wee rabbit, blinking his eyes and bouncing frantically from tree to tree to pond to pond.  &#8220;His snout was a <strong><span class="caps">HUGE</span></strong> responsibility!!  His smoky breath was <em>mine to reckon with!!</em> I spent fifty dollars on the cab <strong><span class="caps">JUST</span></strong> to get out there, which was another <em>huge huge</em> ordeal.  You have <em>nothing on me</em>, not a <em>single</em> indictment, my whole <strong><span class="caps">HERONESS</span></strong> is <em>absoflutely unimpeachable</em>, my whole <strong><span class="caps">APPROACH</span></strong> is <em>abassoonly unapricotable</em>, just ask Lester.&#8221;</p>

    
    
        
        <div class="sidebar">
        <h1>sidebar!</h1>
        
        <h2>The Inadvertant Meteor</h2>
        

        <p><em>When I first began my inquiry into preeventualism, I was relayed the following story.  I was told that this was all I needed to understand the philosophy.</em></p>


	<p>There was this sculptor who just wasn&#8217;t satisfied with his work.  He had primarily studied traditional subject matter and excelled at sculpting both the human figure and elaborate vegetation.  And he was really quite an exquisite sculptor.  He just didn&#8217;t feel like he was making his mark upon the world.</p>


	<p>By this time, he had aged well into his fifties and wanted to vaunt into the realm of legendary masters. So he began to construct a massive sculpture of two pears with beads of dew clinging precariously to them.</p>


	<p>The sculpture was enormous and hovered ominously above the sculptor&#8217;s hometown, held aloof by a massive infrastructure of struts and beams. In fact, the giant pears were so significant that they truly wreaked havoc on the Earth&#8217;s rotation, everso slightly, what with a new asteroid-sized fruit basket clinging to it.</p>


	<p>The government sent jets and warcrafts to destroy the statue.  They unleashed a vicious attack on the village, dismantling the statue, blowing it into thousands of pieces, chipping away at it with missiles.  Soon enough, the statue was obliterated and all was back to normal.</p>


	<p>A huge chunk of the statue had taken orbit in the heavens and often veered perilously close to the planet.  When it did, it was always met by an arsenal of advanced weaponry, which further damaged it and deflected its course skyward.</p>


	<p>Eventually, this inadvertant meteor was nothing more than the size of a very daunting man.  And, when it at last hit the ground, weathered and polished by its ninety year journey, it was hailed as an enigmatic masterpiece, a message from the great beyond.  Here was a stunning likeness of a male nude looking  wistfully into the sky with an intricate lacework of vines creeping around his waist and covering his  improprieties.</p>


	<p>The statue was last sold for fifty-two million dollars and stayed in the permanent exhibit at the Louvre, with the plaque:</p>


	<blockquote>
		<p>&#8220;Heavenly Nude&#8221; by Anonymous</p>
	</blockquote>
        <h1>sidebar!</h1>
        </div>

    
    

        <p>&#8220;Who&#8217;s Lester?&#8221; said the Fox Small.</p>


	<p>&#8220;Lester&#8217;s my cab driver!  He parked at the base of Dwemthy&#8217;s Array!!&#8221;  The rabbit ricocheted madly like a screensaver for a supercomputer.  <em>&#8220;Just ask Dwemthy!!&#8221;</em></p>


	<p>&#8220;Well,&#8221; said the Fox Small.  He turned back to look up at Fox Tall, who was sitting straight and looking far into the distance.  &#8220;Wait, they have a parking lot on Dwemthy&#8217;s Array?&#8221;</p>


	<p><strong>&#8220;YEP!!</strong>  And a pretzel stand!!&#8221;</p>


	<p>&#8220;But, it&#8217;s <em>an Array</em>?  Do they sell churros?&#8221;</p>


	<p><strong>&#8220;CHOCOLAVA!!&#8221;</strong> bleeted the rabbit.</p>


	<p>&#8220;What about those glow-in-the-dark ropes that you can put in your hair?  Or you can just hold them by your side or up in the air&#8212;&#8221;</p>


	<p><strong>&#8220;BRAIDQUEST!!&#8221;</strong></p>


	<p>&#8220;You should get a cut of the salesman&#8217;s commission,&#8221; spoke Fox Small.  &#8220;Folks came out to see you kill the dragon, right?&#8221;</p>


	<p><strong>&#8220;BUT!!</strong>  I don&#8217;t operate the tongs that actually extract the chocolava.&#8221;</p>


	<p>&#8220;I&#8217;m just sayin.  You <strong>do</strong> operate the killing mechanism.  So you <em>have a stake</em> in the ensalada.&#8221;</p>


	<p>&#8220;OH NO!!  I left my favorite lettuce leaves in Dwemthy&#8217;s Array!!&#8221; squealed the rabbit, twirling like a celebratory saber through the quaking oak.  Distantly: &#8220;Or Lester&#8217;s trunk, maybe?&#8221;</p>


	<p>&#8220;You know&#8212;Gheesh, can you stay put??&#8221; said Fox Small.</p>


	<p>&#8220;My radio,&#8221; said Fox Tall, stirring to life for a moment, &#8220;in my pickup.&#8221;  The glaze still seeping from his eyes.  His stare quivered and set back into his face, recalling another time and place.  A drive out to Maryland.  Sounds of Lionel Richie coming in so clearly.  The wipers going a bit too fast.  He pulls up to a house.  His mother answers the door. She is a heavily fluffed fox.  Tears and makeup.</p>


	<p>Slumping back down, &#8220;That porcupine is changing my presets.&#8221;</p>


	<p>The rabbit bounded up on to the armrest of the park bench and spoke closely.  <strong>&#8220;BUT!!</strong> Soon I will feast on drgn&#8217;s head and the juices of drgn&#8217;s tongue!!&#8221;  The rabbit sat still and held his paws kindly.</p>


	<p>&#8220;(Which I hope will taste like cinnamon bears,)&#8221; whispered the rabbit, intimately.</p>


	<p>&#8220;I love cinammon,&#8221; said Fox Small.  &#8220;I should go killing with you some time.&#8221;</p>


	<p>&#8220;You should,&#8221; said the rabbit and the eyes shine-shined.</p>


	<p>&#8220;Although, salivating over a tongue.  You don&#8217;t salivate over it, do you?&#8221;</p>


	<p>&#8220;I DO!!&#8221; and the rabbit got so excited that Sticky Whip shot out of his eyes.  (More on Sticky Whip in a later sidebar. Don&#8217;t let me forget.  See also: <em>The Purist&#8217;s Compendium to Novelty Retinal Cremes</em> by Jory Patrick Sobgoblin, available wherever animal attachment clips are sold.)</p>


	<p>&#8220;Okay, you&#8217;ve hooked me.  I want to hear all about it,&#8221; Fox Small declared. &#8220;Please, talk freely about the chimbly.  Oh, and Dwemthy.  Who is he?  What makes him tick?  Then maybe, if I&#8217;m still around after that, you can tell me about what makes rabbits tick, and maybe you can hold our hands through this whole missing truck ordeal. I need consolation more than anything else.  I could probably use religion right now.  I could use your personal bravery and this sense of accomplishment you exude.  Do you smoke a pipe?  Could be a handy tool to coax along the pontification we must engage in.&#8221;</p>


	<p>And the rabbit began expounding upon Dwemthy and the legend of Dwemthy and the ways of Dwemthy. As with most stories of Dwemthy, the rabbit&#8217;s tales were mostly embellishments. Smotchkkiss, there are delicacies which I alone must address.</p>


	<p>Please, never ask who Dwemthy is. Obviously he is a mastermind and would never disclose his location or true identity. He has sired dynasties. He has set living ogres aflame. Horses everywhere smell him at all times. Most of all, he knows carnal pleasures. And to think that this&#8230;</p>


	<p>This is his Array.</p>


	<h3>Dwemthy&#8217;s Array</h3>


	<p><img src="../images/dwemthy-asweome.gif" title="Dwemthy's Array has charmed and tormented the village folk for centuries." alt="Dwemthy's Array has charmed and tormented the village folk for centuries." /></p>


	<p>You stand at the entrance of Dwemthy&#8217;s Array.  You are a rabbit who is about to die. And deep at the end of the Array:</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Dragon</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">1340</span>     <span class="comment"># tough scales</span>
   <span class="ident">strength</span> <span class="number">451</span>  <span class="comment"># bristling veins</span>
   <span class="ident">charisma</span> <span class="number">1020</span> <span class="comment"># toothy smile</span>
   <span class="ident">weapon</span> <span class="number">939</span>    <span class="comment"># fire breath</span>
 <span class="keyword">end</span></code></pre></div>

	<p>A scalding <em><span class="caps">SEETHING LAVA</span></em> infiltrates the <strong>cacauphonous <span class="caps">ENGORGED MINESHAFTS</span></strong> deep within the ageless canopy of the <em><span class="caps">DWEMTHY FOREST</span></em>... chalky and nocturnal screams from <strong>the belly of the <span class="caps">RAVENOUS WILD STORKUPINE</span></strong>... who eats <strong>wet goslings</strong> <em><span class="caps">RIGHT AFTER</span></em> they&#8217;ve had a few graham crackers and a midday nap&#8230; amidst starved hippos <em><span class="caps">TECHNICALLY ORPHANED</span></em> but truthfully sheltered by umbrellas owned jointly by car dealership conglomerates&#8230; beneath <em>uncapped vials</em> of mildly pulpy <strong><span class="caps">BLUE ELIXIR</span></strong>... <em>which shall remain&#8230; heretofore&#8230; <strong><span class="caps">UNDISTURBED</span>&#8230; <span class="caps">DWEMTHY</span>!!!</strong></em></p>


	<p><img src="../images/wixl.dwemthy-2.gif" title="Luck and mother nature." alt="Luck and mother nature." /></p>


	<p><em>If you don&#8217;t understand Dwemthy&#8217;s Array, it is Dwemthy&#8217;s fault. He designed the game to complicate our lives and were it simpler, it would not be the awe-inspiring quest we&#8217;ve come to cherish in our arms this very hour.</em></p>


	<p>Dwemthy&#8217;s Array has a winding history of great depth.  It is not enough to simply say, &#8220;Dwemthy&#8217;s Array,&#8221; over and over and expect to build credentials from that act alone.  Come with me, I can take you back a couple years, back to the sixties where it all started with metaprogramming and the dolphins.</p>


	<p>You might be inclined to think that <strong>metaprogramming</strong> is another hacker word and was first overheard in private phone calls between fax machines.  Honest to God, I am here to tell you that it is stranger than that. Metaprogramming began with <em>taking drugs in the company of dolphins</em>.</p>


	<p>In the sixties, a prolific scientist named John C. Lilly began experimenting with his own senses, to uncover the workings of his body.  I can relate to this.  I do this frequently when I am standing in the middle of a road holding a pie or when I am hiding inside a cathedral.  I pause to examine my self.  This has proven to be nigh impossible.  I have filled three ruled pages with algebraic notation, none of which has explained anything.  The pie, incidentally, has been very easy to express mathematically.</p>


	<p>But the scientist Lilly went about his experiments otherwise.  He ingested <span class="caps">LSD</span> in the company of dolphins. Often in a dark, woeful isolation tank full of warm salt water.  Pretty bleak.  But it was science!  (Lest you think him criminal: until 1966, <span class="caps">LSD</span> was supplied by Sandoz Laboratories to any interested scientists, free of charge.)</p>


	<p><strong>Drugs, dolphins and deprivation.</strong>  Which led to Lilly&#8217;s foray into things meta.  He wrote books on mental programming, comparing humans and computers.  You may choose to ingest any substance you want during this next quote <del>- most likely you&#8217;re reaching for the grain of salt -</del> but I assure you that there&#8217;s no Grateful Dead show on the lawn and no ravers in the basement.</p>


	<blockquote>
		<p>When one learns to learn, one is making models, using symbols, analogizing, making metaphors, in short, inventing and using language, mathematics, art, politics, business, etc. At the critical brain (cortex) size, languages and its consequences appear. To avoid the necessity of repeating learning to learn, symbols, metaphors, models each time, I symbolize the underlying idea in these operations as metaprogramming.</p>
	</blockquote>


	<blockquote>
		<p class="attrib">John C. Lilly, <em>Programming and Metaprogramming in the Human Biocomputer</em>, New York, 1972.</p>
	</blockquote>


	<p>We learn.  But first we learn to learn.  We setup programming in our mind which is the pathway to further programming.  (Lilly is largely talking about programming the brain and the nervous system, which he collectively called the <em>biocomputer</em>.)</p>


	<p>Lilly&#8217;s metaprogramming was more about feeding yourself imagery, reinventing yourself, all that. This sort of thinking links directly to folks out there who dabble in shamanism, wave their hands over tarot cards and wake up early for karate class.  I guess you could say metaprogramming is New Age, but it&#8217;s all settled down recently into a sleeping bag with plain old nerdiness.  (If you got here from a Google search for &#8220;C++ Metaprogramming&#8221;, stick around, but I only ask that you <em>burn</em> those neural pathways that originally invoked the search.  Many thanks.)</p>


	<p>Meta itself is spoken of no differently in your author&#8217;s present day.</p>


	<blockquote>
		<p>All sensuous response to reality is an interpretation of it.  Beetles and monkeys clearly interpret their world, and act on the basis of what they see. Our physical senses are themselves organs of interpretation.  What distinguishes us from our fellow animals is that we are able in turn to interpret these interpretations.  In that sense, all human language is meta-language.  It is a second-order reflection on the &#8216;language&#8217; of our bodies&#8212;of our sensory apparatus.</p>
	</blockquote>


	<blockquote>
		<p class="attrib">Terry Eagleton, <em>After Theory</em>, London, 2003, ch. 3.</p>
	</blockquote>


	<p>To that end, you could say programming itself is a meta-language.  <em>All code</em> speaks the language of action, of a plan which hasn&#8217;t been played yet, but shortly will.  Stage directions for the players inside your machine.  I&#8217;ve waxed sentimental on this before.</p>


	<p>But now we&#8217;re advancing our study, venturing into metaprogramming, but don&#8217;t sweat it, <strong>it&#8217;s still just the Ruby you&#8217;ve seen already</strong>, which is why Dwemthy feels no qualms thrusting it at you right away.  Soon enough it will be as easy to spot as addition or subtraction.  At first it may seem intensely bright, like you&#8217;ve stumbled across your first firefly, which has flown up in your face.  Then, it becomes just <em>a little bobbing light</em> which makes living in Ohio so much nicer.</p>

    
    
        
        <div class="sidebar">
        <h1>sidebar!</h1>
        
        <h2>Bread Riddles</h2>
        

        <p>Question: Can one take five bites from a bread and make the shape of a bicycle?
Answer: Yes.</p>


	<p>Question: Can one rip a bread in half and still fit the bread in an envelope?
Answer: Yes.</p>


	<p>Question: Can one man take a bread and throw it while another man sits without bread?
Answer: Yes.</p>


	<p>Question: Can four breads in a box be explained?
Answer: Yes.</p>


	<p>Question: Can a clerical error in my company books be attributed to bread?
Answer: Yes.</p>


	<p>Question: Can dancers break through a scrim of bread?
Answer: Yes.</p>


	<p>Question: Can those same dancers, when faced with an inexplicably different scrim of bread, fail to break through?
Answer: Yes.</p>


	<p>Question: Does bread understand my darkest fears and wildest dreams?
Answer: Yes.</p>


	<p>Question: Does bread desire me?
Answer: Yes.</p>


	<p>Question: Will bread be invisible to robots?
Answer: Yes.</p>


	<p>Question: Can one robot take eight bites on a bread, without knowing it&#8217;s there, and make the shape of a smaller bread?
Answer: Yes.</p>


	<p>Question: Should my clerics be equipped with bread?
Answer: Yes.</p>


	<p>Question: In relation to bread, will robots each have their own elephants?
Answer: Yes.</p>


	<p>Question: Can one rip a bread in half and not let it ruin one&#8217;s game of dominoes?
Answer: Yes.</p>


	<p>Question: Will we always love bread?
Answer: Yes.</p>


	<p>Question: Will we have more bread?
Answer: Yes.</p>


	<p>Question: Can four breads marry a robot&#8217;s elephant?
Answer: Yes.</p>
        <h1>sidebar!</h1>
        </div>

    
    

        <p>Metaprogramming is <em>writing code which writes code</em>.  But not as M.C. Escher would sketch it.  <strong>The program isn&#8217;t reaching back around and overwriting itself, nor is the program jumping onto your screen and wrenching the keyboard from your hands.</strong>  No, it&#8217;s much smaller than that.</p>


	<p>Let&#8217;s say it&#8217;s more like <strong>a little orange pill</strong> you won at the circus.  When you suck on it, the coating wears away and behind your teeth hatches a massive, floppy sponge brontosaurus.  He slides down your tongue and leaps free, frollicking  over the pastures, yelping, &#8220;Papa!&#8221;  And from then on, whenever he freaks out and attacks a van, well, that van is <em>sparkling clean</em> afterwards.</p>


	<p>Now, let&#8217;s say <em>someone else</em> puts <strong>their little orange pill</strong> under the faucet.  Not on their tongue, <em>under the faucet</em>.  And this triggers a different catalysm, which births a set of wailing sponge sextuplets.  <strong>Umbilical cords and everything.</strong>  Still very handy for cleaning the van. But an altogether different kind of chamois.  And, one day, these eight will stir Papa to tears when they perform the violin concerto of their lives.</p>


	<p>Metaprogramming is packing code into pill-form, such that a slender drop of water could trigger it to expand. More importantly, you can control the pill&#8217;s reaction, so that a brontosaurus is produced, scaly and lumbering. Or septulets, <strong><span class="caps">CERTAINLY</span></strong>.  Or seamstresses.  Or cat brains.  Or dragons.</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Dragon</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">1340</span>     <span class="comment"># tough scales</span>
   <span class="ident">strength</span> <span class="number">451</span>  <span class="comment"># bristling veins</span>
   <span class="ident">charisma</span> <span class="number">1020</span> <span class="comment"># toothy smile</span>
   <span class="ident">weapon</span> <span class="number">939</span>    <span class="comment"># fire breath</span>
 <span class="keyword">end</span></code></pre></div>

	<p>This is not metaprogramming yet.  Only the pill.  The <em>product</em> of metaprogramming.  We are pausing, looking at the beast itself before descending beneath its flesh with a scalpel and microscope.</p>


	<p>The <code><span class="constant">Dragon</span></code> is a class.  You&#8217;ve seen that many times now.  The <code><span class="constant">Dragon</span></code> is a descendant of the <code><span class="constant">Creature</span></code> class.</p>


	<p>Now, eyes up.  Look at me.  The <code><span class="constant">Creature</span></code> class contains the metaprogramming code.  You can write metaprogramming code which can be used <em>everywhere</em>, throughout Ruby, in <code><span class="constant">Creature</span></code> or <code><span class="constant">Dragon</span></code>, in <code><span class="constant">String</span></code> or in <code><span class="constant">Object</span></code>, anywhere. Our example here, since this is the most common form of meta-code, focuses on metaprogramming inside your own classes only.</p>


	<p>Each of the <code><span class="constant">Dragon</span></code>&#8217;s traits are simply <strong>class methods</strong>.  You could also write this as:</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Dragon</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span><span class="punct">(</span> <span class="number">1340</span> <span class="punct">)</span>     <span class="comment"># tough scales</span>
   <span class="ident">strength</span><span class="punct">(</span> <span class="number">451</span> <span class="punct">)</span>  <span class="comment"># bristling veins</span>
   <span class="ident">charisma</span><span class="punct">(</span> <span class="number">1020</span> <span class="punct">)</span> <span class="comment"># toothy smile</span>
   <span class="ident">weapon</span><span class="punct">(</span> <span class="number">939</span> <span class="punct">)</span>    <span class="comment"># fire breath</span>
 <span class="keyword">end</span></code></pre></div>

	<p>Removing the parens removes clutter, so let&#8217;s leave them out.  Only use parens when you are using several methods together and you want to be very clear.</p>


	<h3>Creature Code</h3>


	<p>Now, with a lateral slice across the diaphragm, we expose the innards of <code><span class="constant">Creature</span></code>.  <strong>Save this code into a file called <code><span class="ident">dwemthy</span><span class="punct">.</span><span class="ident">rb</span></code>.</strong></p>


<div class='example'><pre><code> <span class="comment"># The guts of life force within Dwemthy's Array</span>
 <span class="keyword">class </span><span class="class">Creature</span>

   <span class="comment"># Get a metaclass for this class</span>
   <span class="keyword">def </span><span class="method">self.metaclass</span><span class="punct">;</span> <span class="keyword">class </span><span class="punct">&lt;&lt;</span> <span class="constant">self</span><span class="punct">;</span> <span class="constant">self</span><span class="punct">;</span> <span class="keyword">end</span><span class="punct">;</span> <span class="keyword">end</span>

   <span class="comment"># Advanced metaprogramming code for nice, clean traits</span>
   <span class="keyword">def </span><span class="method">self.traits</span><span class="punct">(</span> <span class="punct">*</span><span class="ident">arr</span> <span class="punct">)</span>
     <span class="keyword">return</span> <span class="attribute">@traits</span> <span class="keyword">if</span> <span class="ident">arr</span><span class="punct">.</span><span class="ident">empty?</span>

     <span class="comment"># 1. Set up accessors for each variable</span>
     <span class="ident">attr_accessor</span> <span class="punct">*</span><span class="ident">arr</span>

     <span class="comment"># 2. Add a new class method to for each trait.</span>
     <span class="ident">arr</span><span class="punct">.</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">a</span><span class="punct">|</span>
       <span class="ident">metaclass</span><span class="punct">.</span><span class="ident">instance_eval</span> <span class="keyword">do</span>
         <span class="ident">define_method</span><span class="punct">(</span> <span class="ident">a</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">val</span><span class="punct">|</span>
           <span class="attribute">@traits</span> <span class="punct">||=</span> <span class="punct">{}</span>
           <span class="attribute">@traits</span><span class="punct">[</span><span class="ident">a</span><span class="punct">]</span> <span class="punct">=</span> <span class="ident">val</span>
         <span class="keyword">end</span>
       <span class="keyword">end</span>
     <span class="keyword">end</span>

     <span class="comment"># 3. For each monster, the `initialize' method</span>
     <span class="comment">#    should use the default number for each trait.</span>
     <span class="ident">class_eval</span> <span class="keyword">do</span>
       <span class="ident">define_method</span><span class="punct">(</span> <span class="symbol">:initialize</span> <span class="punct">)</span> <span class="keyword">do</span>
         <span class="constant">self</span><span class="punct">.</span><span class="ident">class</span><span class="punct">.</span><span class="ident">traits</span><span class="punct">.</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">k</span><span class="punct">,</span><span class="ident">v</span><span class="punct">|</span>
           <span class="ident">instance_variable_set</span><span class="punct">(&quot;</span><span class="string">@<span class="expr">#{k}</span></span><span class="punct">&quot;,</span> <span class="ident">v</span><span class="punct">)</span>
         <span class="keyword">end</span>
       <span class="keyword">end</span>
     <span class="keyword">end</span>

   <span class="keyword">end</span>

   <span class="comment"># Creature attributes are read-only</span>
   <span class="ident">traits</span> <span class="symbol">:life</span><span class="punct">,</span> <span class="symbol">:strength</span><span class="punct">,</span> <span class="symbol">:charisma</span><span class="punct">,</span> <span class="symbol">:weapon</span>
 <span class="keyword">end</span></code></pre></div>

	<p>Focus on the closing lines of code, specifically the line where the <code><span class="ident">traits</span></code> are being set up.  All of the code before that line sets up the <code><span class="ident">traits</span></code> class method.  This bears resemblance to the basic lottery tickets from the chapter previous.</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">LotteryTicket</span>
   <span class="ident">attr_reader</span> <span class="symbol">:picks</span><span class="punct">,</span> <span class="symbol">:purchased</span>
 <span class="keyword">end</span></code></pre></div>

	<p>Both <code><span class="ident">traits</span></code> and <code><span class="ident">attr_reader</span></code> are simply class methods.  When <code><span class="ident">attr_reader</span></code> is used in the <code><span class="constant">LotteryTicket</span></code>, metaprogramming kicks in behind the scenes and starts blowing up balloons, creating <strong>reader</strong> methods for the instance variables <code><span class="attribute">@picks</span></code> and <code><span class="attribute">@purchased</span></code> above.</p>


	<p>The code for the <code><span class="ident">traits</span></code> method is the metaprogramming I&#8217;ve been alluding to. Comments in the code reveal the three stages the method goes through when adding traits.</p>


	<ol>
	<li>The <strong>list of traits is passed on to <code><span class="ident">attr_accessor</span></code></strong>, which builds <strong>reader</strong> and <strong>writer</strong> code for instance variables.  One for each trait.</li>
		<li><strong>Class methods are added</strong> for each trait.  (A <code><span class="ident">life</span></code> class method is added for a <code><span class="symbol">:life</span></code> trait.)  These class methods are used in the class definition just like you would use <code><span class="ident">traits</span></code> or <code><span class="ident">attr_accessor</span></code>.  This way, you can specify the trait, along with the points given for a trait to a certain creature.</li>
		<li><strong>Add an initialize method</strong> which sets up a new monster properly, grabbing the right points and <em><span class="caps">POWER UP</span>! POWER UP!</em> the monster is alive!</li>
	</ol>


	<p>The beauty of these three steps is that you&#8217;ve taught Ruby how to code monsters for you.  So when Ruby gets to the <code><span class="ident">traits</span></code>:</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Creature</span>
   <span class="ident">traits</span> <span class="symbol">:life</span><span class="punct">,</span> <span class="symbol">:strength</span><span class="punct">,</span> <span class="symbol">:charisma</span><span class="punct">,</span> <span class="symbol">:weapon</span>
 <span class="keyword">end</span></code></pre></div>

	<p>Ruby fills in the code behind the scenes and transplants a spiny green heart and jumpstarts the body with a pullcord. Ruby will use the metaprogramming from the <code><span class="constant">Creature</span></code> class and build out all the various methods, expanding the <code><span class="ident">traits</span></code> list like this:</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Creature</span>

   <span class="comment"># 1. set up reader and writer methods</span>
   <span class="ident">attr_accessor</span> <span class="symbol">:life</span><span class="punct">,</span> <span class="symbol">:strength</span><span class="punct">,</span> <span class="symbol">:charisma</span><span class="punct">,</span> <span class="symbol">:weapon</span>

   <span class="comment"># 2. add new class methods to use in creature</span>
   <span class="keyword">def </span><span class="method">self.life</span><span class="punct">(</span> <span class="ident">val</span> <span class="punct">)</span>
     <span class="attribute">@traits</span> <span class="punct">||=</span> <span class="punct">{}</span>
     <span class="attribute">@traits</span><span class="punct">['</span><span class="string">life</span><span class="punct">']</span> <span class="punct">=</span> <span class="ident">val</span>
   <span class="keyword">end</span>

   <span class="keyword">def </span><span class="method">self.strength</span><span class="punct">(</span> <span class="ident">val</span> <span class="punct">)</span>
     <span class="attribute">@traits</span> <span class="punct">||=</span> <span class="punct">{}</span>
     <span class="attribute">@traits</span><span class="punct">['</span><span class="string">strength</span><span class="punct">']</span> <span class="punct">=</span> <span class="ident">val</span>
   <span class="keyword">end</span>

   <span class="keyword">def </span><span class="method">self.charisma</span><span class="punct">(</span> <span class="ident">val</span> <span class="punct">)</span>
     <span class="attribute">@traits</span> <span class="punct">||=</span> <span class="punct">{}</span>
     <span class="attribute">@traits</span><span class="punct">['</span><span class="string">charisma</span><span class="punct">']</span> <span class="punct">=</span> <span class="ident">val</span>
   <span class="keyword">end</span>

   <span class="keyword">def </span><span class="method">self.weapon</span><span class="punct">(</span> <span class="ident">val</span> <span class="punct">)</span>
     <span class="attribute">@traits</span> <span class="punct">||=</span> <span class="punct">{}</span>
     <span class="attribute">@traits</span><span class="punct">['</span><span class="string">weapon</span><span class="punct">']</span> <span class="punct">=</span> <span class="ident">val</span>
   <span class="keyword">end</span>

   <span class="comment"># 3. initialize sets the default points for</span>
   <span class="comment">#    each trait</span>
   <span class="keyword">def </span><span class="method">initialize</span>
     <span class="constant">self</span><span class="punct">.</span><span class="ident">class</span><span class="punct">.</span><span class="ident">traits</span><span class="punct">.</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">k</span><span class="punct">,</span><span class="ident">v</span><span class="punct">|</span>
       <span class="ident">instance_variable_set</span><span class="punct">(&quot;</span><span class="string">@<span class="expr">#{k}</span></span><span class="punct">&quot;,</span> <span class="ident">v</span><span class="punct">)</span>
     <span class="keyword">end</span>
   <span class="keyword">end</span>

 <span class="keyword">end</span></code></pre></div>

	<p>Now, Ruby will gladly accept this six-line <code><span class="constant">Dragon</span></code> code, short enough to look nice when printed on playing cards:</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Dragon</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">1340</span>     <span class="comment"># tough scales</span>
   <span class="ident">strength</span> <span class="number">451</span>  <span class="comment"># bristling veins</span>
   <span class="ident">charisma</span> <span class="number">1020</span> <span class="comment"># toothy smile</span>
   <span class="ident">weapon</span> <span class="number">939</span>    <span class="comment"># fire breath</span>
 <span class="keyword">end</span></code></pre></div>

	<h3>Eval, the Littlest Metaprogrammer</h3>


	<p>While the metaprogramming code above is just plain Ruby, it can be difficult to follow still. I totally understand if you&#8217;ve come to this point and your eyes are spinning in their sockets and your knees have locked up.  The trickiest parts of the above are the lines which call the methods <code><span class="ident">instance_eval</span></code> and <code><span class="ident">class_eval</span></code>.  Just rub some tiger balm on your joints while I talk about <code><span class="ident">eval</span></code>.</p>


	<p>We&#8217;ve been talking about <strong>metaprogramming</strong>.  Writing code which writes code.  The <code><span class="ident">eval</span></code> method hangs out in this alley. The vagrant <code><span class="ident">eval</span></code> takes code you have stored up in a string and it executes that code.</p>


<div class='example'><pre><code> <span class="ident">drgn</span> <span class="punct">=</span> <span class="constant">Dragon</span><span class="punct">.</span><span class="ident">new</span>
 <span class="comment"># is identical to...</span>
 <span class="ident">drgn</span> <span class="punct">=</span> <span class="ident">eval</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">Dragon.new</span><span class="punct">&quot;</span> <span class="punct">)</span>
 <span class="comment"># or, alternatively...</span>
 <span class="ident">eval</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">drgn = Dragon.new</span><span class="punct">&quot;</span> <span class="punct">)</span></code></pre></div>

	<p>Here, let&#8217;s write a program which has a hole in it.  Instead of writing a program which creates a new <code><span class="constant">Dragon</span></code>, let&#8217;s leave a hole where the <code><span class="constant">Dragon</span></code> would be.</p>


<div class='example'><pre><code> <span class="ident">print</span> <span class="punct">&quot;</span><span class="string">What monster class have you come to battle? </span><span class="punct">&quot;</span> 
 <span class="ident">monster_class</span> <span class="punct">=</span> <span class="ident">gets</span>
 <span class="ident">eval</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">monster = </span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">monster_class</span> <span class="punct">+</span> <span class="punct">&quot;</span><span class="string">.new</span><span class="punct">&quot;</span> <span class="punct">)</span>
 <span class="ident">p</span> <span class="ident">monster</span></code></pre></div>

	<p>The program asks for a monster.  If you type in <code><span class="constant">Dragon</span></code>, then the <code><span class="ident">monster_class</span></code> variable will contain the string <code><span class="punct">&quot;</span><span class="string">Dragon</span><span class="punct">&quot;</span></code>.  Inside the <code><span class="ident">eval</span></code>, a few strings get added together to make the string <code><span class="punct">&quot;</span><span class="string">monster = Dragon.new</span><span class="punct">&quot;</span></code>.  And when the <code><span class="ident">eval</span></code> executes this string, the <code><span class="ident">monster</span></code> variable contains a <code><span class="constant">Dragon</span></code> object.  Ready for battle.</p>


	<p>This is great!  Now we can leave it up to the player to pick a monster!  Of course, we&#8217;re trusting the player to supply a real monster class.  If they type in <code><span class="constant">BotanicalWitch</span></code> and there is no <code><span class="constant">BotanicalWitch</span></code> class, they&#8217;ll get an exception tossed in their face.</p>


	<p>So, in short, <code><span class="ident">eval</span></code> lets you make up code as you go.  Which can be useful and which can be dangerous as well.</p>


	<p>The <code><span class="ident">instance_eval</span></code> and <code><span class="ident">class_eval</span></code> method used in the metaprogramming for the <code><span class="constant">Creature</span></code> class are slightly different from the normal <code><span class="ident">eval</span></code>.  These two special methods run code just like <code><span class="ident">eval</span></code> does, but they duck into classes and objects and run the code there.</p>


<div class='example'><pre><code> <span class="comment"># The instance_eval method runs code as if it were run inside an</span>
 <span class="comment"># object's instance method.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">drgn</span> <span class="punct">=</span> <span class="constant">Dragon</span><span class="punct">.</span><span class="ident">new</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">drgn</span><span class="punct">.</span><span class="ident">instance_eval</span> <span class="keyword">do</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="attribute">@name</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">Tobias</span><span class="punct">&quot;</span> 
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">end</span>

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">drgn</span><span class="punct">.</span><span class="ident">instance_variable_get</span><span class="punct">(</span> <span class="punct">&quot;</span><span class="string">@name</span><span class="punct">&quot;</span> <span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Tobias</span><span class="punct">&quot;</span> 

 <span class="comment"># The class_eval method runs code is if inside a class definition.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="constant">Dragon</span><span class="punct">.</span><span class="ident">class_eval</span> <span class="keyword">do</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="keyword">def </span><span class="method">name</span><span class="punct">;</span> <span class="attribute">@name</span><span class="punct">;</span> <span class="keyword">end</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">end</span>

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">drgn</span><span class="punct">.</span><span class="ident">name</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Tobias</span><span class="punct">&quot;</span></code></pre></div>

	<p>As you can see above, the <code><span class="ident">instance_eval</span></code> and <code><span class="ident">class_eval</span></code> methods also can take a code block instead of a string.  Which is just how things are done in Dwemthy&#8217;s Array.</p>


	<h3>Enough Belittling Instruction and Sly Juxtaposition&#8212;Where Is Dwemthy&#8217;s Array??</h3>


	<p>Tread carefully&#8212;here is <strong>the other half of <span class="caps">DWEMTHY</span>&#8217;S <span class="caps">ARRAY</span>!!</strong> <strong>Add these lines to <code><span class="ident">dwemthy</span><span class="punct">.</span><span class="ident">rb</span></code>.</strong></p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Creature</span>

   <span class="comment"># This method applies a hit taken during a fight.</span>
   <span class="keyword">def </span><span class="method">hit</span><span class="punct">(</span> <span class="ident">damage</span> <span class="punct">)</span>
     <span class="ident">p_up</span> <span class="punct">=</span> <span class="ident">rand</span><span class="punct">(</span> <span class="ident">charisma</span> <span class="punct">)</span>
     <span class="keyword">if</span> <span class="ident">p_up</span> <span class="punct">%</span> <span class="number">9</span> <span class="punct">==</span> <span class="number">7</span>
       <span class="attribute">@life</span> <span class="punct">+=</span> <span class="ident">p_up</span> <span class="punct">/</span> <span class="number">4</span>
       <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[<span class="expr">#{ self.class }</span> magick powers up <span class="expr">#{ p_up }</span>!]</span><span class="punct">&quot;</span> 
     <span class="keyword">end</span> 
     <span class="attribute">@life</span> <span class="punct">-=</span> <span class="ident">damage</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[<span class="expr">#{ self.class }</span> has died.]</span><span class="punct">&quot;</span> <span class="keyword">if</span> <span class="attribute">@life</span> <span class="punct">&lt;=</span> <span class="number">0</span>
   <span class="keyword">end</span>

   <span class="comment"># This method takes one turn in a fight.</span>
   <span class="keyword">def </span><span class="method">fight</span><span class="punct">(</span> <span class="ident">enemy</span><span class="punct">,</span> <span class="ident">weapon</span> <span class="punct">)</span>
     <span class="keyword">if</span> <span class="ident">life</span> <span class="punct">&lt;=</span> <span class="number">0</span>
       <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[<span class="expr">#{ self.class }</span> is too dead to fight!]</span><span class="punct">&quot;</span> 
       <span class="keyword">return</span>
     <span class="keyword">end</span>

     <span class="comment"># Attack the opponent</span>
     <span class="ident">your_hit</span> <span class="punct">=</span> <span class="ident">rand</span><span class="punct">(</span> <span class="ident">strength</span> <span class="punct">+</span> <span class="ident">weapon</span> <span class="punct">)</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[You hit with <span class="expr">#{ your_hit }</span> points of damage!]</span><span class="punct">&quot;</span> 
     <span class="ident">enemy</span><span class="punct">.</span><span class="ident">hit</span><span class="punct">(</span> <span class="ident">your_hit</span> <span class="punct">)</span>

     <span class="comment"># Retaliation</span>
     <span class="ident">p</span> <span class="ident">enemy</span>
     <span class="keyword">if</span> <span class="ident">enemy</span><span class="punct">.</span><span class="ident">life</span> <span class="punct">&gt;</span> <span class="number">0</span>
       <span class="ident">enemy_hit</span> <span class="punct">=</span> <span class="ident">rand</span><span class="punct">(</span> <span class="ident">enemy</span><span class="punct">.</span><span class="ident">strength</span> <span class="punct">+</span> <span class="ident">enemy</span><span class="punct">.</span><span class="ident">weapon</span> <span class="punct">)</span>
       <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[Your enemy hit with <span class="expr">#{ enemy_hit }</span> points of damage!]</span><span class="punct">&quot;</span> 
       <span class="constant">self</span><span class="punct">.</span><span class="ident">hit</span><span class="punct">(</span> <span class="ident">enemy_hit</span> <span class="punct">)</span>
     <span class="keyword">end</span>
   <span class="keyword">end</span>

 <span class="keyword">end</span>

 <span class="keyword">class </span><span class="class">DwemthysArray</span> <span class="punct">&lt;</span> <span class="constant">Array</span>
   <span class="keyword">alias</span> <span class="ident">_inspect</span> <span class="ident">inspect</span>
   <span class="keyword">def </span><span class="method">inspect</span><span class="punct">;</span> <span class="punct">&quot;</span><span class="string">#&lt;<span class="expr">#{ self.class }#{ _inspect }</span>&gt;</span><span class="punct">&quot;;</span> <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">method_missing</span><span class="punct">(</span> <span class="ident">meth</span><span class="punct">,</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
     <span class="ident">answer</span> <span class="punct">=</span> <span class="ident">first</span><span class="punct">.</span><span class="ident">send</span><span class="punct">(</span> <span class="ident">meth</span><span class="punct">,</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
     <span class="keyword">if</span> <span class="ident">first</span><span class="punct">.</span><span class="ident">life</span> <span class="punct">&lt;=</span> <span class="number">0</span>
       <span class="ident">shift</span>
       <span class="keyword">if</span> <span class="ident">empty?</span>
         <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[Whoa.  You decimated Dwemthy's Array!]</span><span class="punct">&quot;</span> 
       <span class="keyword">else</span>
         <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[Get ready. <span class="expr">#{ first.class }</span> has emerged.]</span><span class="punct">&quot;</span> 
       <span class="keyword">end</span>
     <span class="keyword">end</span>
     <span class="ident">answer</span> <span class="punct">||</span> <span class="number">0</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>This code adds two methods to <code><span class="constant">Creature</span></code>.  The <code><span class="ident">hit</span></code> method which reacts to a hit from another <code><span class="constant">Creature</span></code>.  And the <code><span class="ident">fight</span></code> method which lets you place your own blows against that <code><span class="constant">Creature</span></code>.</p>


	<p>When your <code><span class="constant">Creature</span></code> takes a hit, a bit of defense kicks in and your <code><span class="ident">charisma</span></code> value is used to generate a power-up.  Don&#8217;t ask me to explain the secrets behind this phenomenon.  A random number is picked, some simple math is done, and, if you&#8217;re lucky, you get a couple life points.  <code><span class="attribute">@life</span> <span class="punct">+=</span> <span class="ident">p_up</span> <span class="punct">/</span> <span class="number">4</span></code>.</p>


	<p>Then, the enemy&#8217;s blow is landed.  <code><span class="attribute">@life</span> <span class="punct">-=</span> <span class="ident">damage</span></code>.  That&#8217;s how the <code><span class="constant">Creature</span><span class="comment">#hit</span></code> method works.</p>


	<p>The <code><span class="ident">fight</span></code> method checks to see if your <code><span class="constant">Creature</span></code> is alive.  Next, a random hit is placed on your opponent.  If your opponent lives through the hit, it gets a chance to strike back.  Those are the workings of the <code><span class="constant">Creature</span><span class="comment">#fight</span></code> method.</p>


	<p>I&#8217;ll explain <code><span class="constant">DwemthysArray</span></code> in a second.  I really will.  I&#8217;m having fun doing it. Let&#8217;s stick with hitting and fighting for now.</p>


	<h3>Introducing: You.</h3>


	<p>You may certainly tinker with derivations on this rabbit.  But official Dwemthy Paradigms explicitly denote the code <del>- and the altogether character -</del> inscribed below.  <strong>Save this as <code><span class="ident">rabbit</span><span class="punct">.</span><span class="ident">rb</span></code>.</strong></p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">Rabbit</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">traits</span> <span class="symbol">:bombs</span>

   <span class="ident">life</span> <span class="number">10</span>
   <span class="ident">strength</span> <span class="number">2</span>
   <span class="ident">charisma</span> <span class="number">44</span>
   <span class="ident">weapon</span> <span class="number">4</span>
   <span class="ident">bombs</span> <span class="number">3</span>

   <span class="comment"># little boomerang</span>
   <span class="keyword">def </span><span class="method">^</span><span class="punct">(</span> <span class="ident">enemy</span> <span class="punct">)</span>
     <span class="ident">fight</span><span class="punct">(</span> <span class="ident">enemy</span><span class="punct">,</span> <span class="number">13</span> <span class="punct">)</span>
   <span class="keyword">end</span>
   <span class="comment"># the hero's sword is unlimited!!</span>
   <span class="keyword">def </span><span class="method">/</span><span class="punct">(</span> <span class="ident">enemy</span> <span class="punct">)</span>
     <span class="ident">fight</span><span class="punct">(</span> <span class="ident">enemy</span><span class="punct">,</span> <span class="ident">rand</span><span class="punct">(</span> <span class="number">4</span> <span class="punct">+</span> <span class="punct">(</span> <span class="punct">(</span> <span class="ident">enemy</span><span class="punct">.</span><span class="ident">life</span> <span class="punct">%</span> <span class="number">10</span> <span class="punct">)</span> <span class="punct">**</span> <span class="number">2</span> <span class="punct">)</span> <span class="punct">)</span> <span class="punct">)</span>
   <span class="keyword">end</span>
   <span class="comment"># lettuce will build your strength and extra ruffage</span>
   <span class="comment"># will fly in the face of your opponent!!</span>
   <span class="keyword">def </span><span class="method">%</span><span class="punct">(</span> <span class="ident">enemy</span> <span class="punct">)</span>
     <span class="ident">lettuce</span> <span class="punct">=</span> <span class="ident">rand</span><span class="punct">(</span> <span class="ident">charisma</span> <span class="punct">)</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[Healthy lettuce gives you <span class="expr">#{ lettuce }</span> life points!!]</span><span class="punct">&quot;</span> 
     <span class="attribute">@life</span> <span class="punct">+=</span> <span class="ident">lettuce</span>
     <span class="ident">fight</span><span class="punct">(</span> <span class="ident">enemy</span><span class="punct">,</span> <span class="number">0</span> <span class="punct">)</span>
   <span class="keyword">end</span>
   <span class="comment"># bombs, but you only have three!!</span>
   <span class="keyword">def </span><span class="method">*</span><span class="punct">(</span> <span class="ident">enemy</span> <span class="punct">)</span>
     <span class="keyword">if</span> <span class="attribute">@bombs</span><span class="punct">.</span><span class="ident">zero?</span>
       <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[UHN!! You're out of bombs!!]</span><span class="punct">&quot;</span> 
       <span class="keyword">return</span>
     <span class="keyword">end</span>
     <span class="attribute">@bombs</span> <span class="punct">-=</span> <span class="number">1</span>
     <span class="ident">fight</span><span class="punct">(</span> <span class="ident">enemy</span><span class="punct">,</span> <span class="number">86</span> <span class="punct">)</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>You have four weapons.  The boomerang.  The hero&#8217;s sword.  The lettuce.  And the bombs.</p>


	<p>To start off, open up <code><span class="ident">irb</span></code> and load the libraries we&#8217;ve created above.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">require</span> <span class="punct">'</span><span class="string">dwemthy</span><span class="punct">'</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">require</span> <span class="punct">'</span><span class="string">rabbit</span><span class="punct">'</span></code></pre></div>

	<p>Now, unroll yourself.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> <span class="punct">=</span> <span class="constant">Rabbit</span><span class="punct">.</span><span class="ident">new</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span><span class="punct">.</span><span class="ident">life</span>
   <span class="punct">=&gt;</span> <span class="number">10</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span><span class="punct">.</span><span class="ident">strength</span>
   <span class="punct">=&gt;</span> <span class="number">2</span></code></pre></div>

	<p>Good, good.</p>


	<h3>Rabbit Fights ScubaArgentine!</h3>


	<p>You cannot just go rushing into Dwemthy&#8217;s Array, unseatbelted and merely perfumed!!  You must advance deliberately through the demonic cotillion.  Or south, through the thickets and labyrinth of coal.</p>


	<p>For now, let&#8217;s lurk covertly through the milky residue alongside the aqueducts.  And  sneak up on the <code><span class="constant">ScubaArgentine</span></code>.</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">ScubaArgentine</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">46</span>
   <span class="ident">strength</span> <span class="number">35</span>
   <span class="ident">charisma</span> <span class="number">91</span>
   <span class="ident">weapon</span> <span class="number">2</span>
 <span class="keyword">end</span></code></pre></div>

	<p>To get the fight started, make sure you&#8217;ve created one of you and one of the <code><span class="constant">ScubaArgentine</span></code>.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> <span class="punct">=</span> <span class="constant">Rabbit</span><span class="punct">.</span><span class="ident">new</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">s</span> <span class="punct">=</span> <span class="constant">ScubaArgentine</span><span class="punct">.</span><span class="ident">new</span></code></pre></div>

	<p>Now use the little boomerang!</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> ^ <span class="ident">s</span>
 <span class="punct">[</span><span class="constant">You</span> <span class="ident">hit</span> <span class="ident">with</span> <span class="number">2</span> <span class="ident">points</span> <span class="ident">of</span> <span class="ident">damage!</span><span class="punct">]</span>
 <span class="comment">#&lt;ScubaArgentine:0x808c864 @charisma=91, @strength=35, @life=44, @weapon=2&gt;</span>
 <span class="punct">[</span><span class="constant">Your</span> <span class="ident">enemy</span> <span class="ident">hit</span> <span class="ident">with</span> <span class="number">28</span> <span class="ident">points</span> <span class="ident">of</span> <span class="ident">damage!</span><span class="punct">]</span>
 <span class="punct">[</span><span class="constant">Rabbit</span> <span class="ident">has</span> <span class="ident">died</span><span class="punct">.]</span></code></pre></div>

	<p>For crying out loud!!  Our sample rabbit died!!</p>

    
    
        
        <div class="sidebar">
        <h1>sidebar!</h1>
        
        <h2>The Shoes Which Lies Are Made Of</h2>
        

        <p><em>Earlier, I told you that &#8220;The Inadvertant Meteor&#8221; was the only story you need to know in order to understand preeventualism.  But, really, all you need to understand about preeventualism is that it is still in its infancy and any of its most basic concepts could change.</em></p>


	<p><em>Which is why I&#8217;ve authored a competing story which I believe uncovers an entirely different and very relevant intellectual scenario.</em></p>


	<p>There was a guy who had been around the block.  And he wasn&#8217;t very old, so he decided to write a biography of his life.</p>


	<p>Well, he started to lie in his biography.  He made up some stories.  But mostly little stories that were inconsequential.  Filler.  Like he had a story about a painting he&#8217;d done of a red background with elephant legs in front.</p>


	<p>But he hadn&#8217;t ever painted anything of the sort.  He further embellished the story by talking about a pricey auction he&#8217;d snuck into.  An auction in New York City where he&#8217;d he overheard his painting go to sale for twenty grand.  But that wasn&#8217;t the point of the story.  The point was that he could fold his body to fit under a lid on a banquet tray.  People would raise the lid and they wouldn&#8217;t even notice him bracing himself inside.  He didn&#8217;t even mention the price his painting sold at.</p>


	<p>Anyway, he really started to like that story (and others like it), to the point where he started to ignore his friends and family, instead preferring to watch what his lie self did after the auction.  In his head.</p>


	<p>So, then, one day he was shopping and he found a pair of shoes that had stripey laces. And he grabbed the shoes and went to the store counter, forcing them in the cashier&#8217;s face, yelling, &#8220;Look! Look at these! Look! These are the shoes my lie self would wear!&#8221;  And he bought the shoes and put them on and the whole Earth cracked open and the cash register popped open and swallowed him up and he was suddenly elsewhere, in his lie apartment, sitting down to paint dolphin noses, three of them on a green background.</p>


	<p>It was a lot of work, painting all those noses.  And he went broke for a while and had to stoop so low as to filming abominable snowman <span class="caps">NASCAR</span>.</p>
        <h1>sidebar!</h1>
        </div>

    
    

        <p>Grim prospects.  I can&#8217;t ask you to return to the rabbit kingdom, though. Just pretend like you didn&#8217;t die and make a whole new rabbit.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> <span class="punct">=</span> <span class="constant">Rabbit</span><span class="punct">.</span><span class="ident">new</span>

 <span class="comment"># attacking with boomerang!</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> ^ <span class="ident">s</span>

 <span class="comment"># the hero's sword slashes!</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> <span class="punct">/</span> <span class="ident">s</span>

 <span class="comment"># eating lettuce gives you life!</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> <span class="punct">%</span> <span class="ident">s</span>

 <span class="comment"># you have three bombs!</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> <span class="punct">*</span> <span class="ident">s</span></code></pre></div>

	<p>Pretty neat looking, wouldn&#8217;t you say?  The code in <code><span class="ident">rabbit</span><span class="punct">.</span><span class="ident">rb</span></code> alters a few math symbols which work only with the <code><span class="constant">Rabbit</span></code>.  Ruby allows you to change the behavior of math operators.  After all, <strong>math operators are just methods!</strong></p>


<div class='example'><pre><code> <span class="comment"># the boomerang is normally an XOR operator.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="number">1</span><span class="punct">.^(</span> <span class="number">1</span> <span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="number">0</span>

 <span class="comment"># the hero's sword normally divides numbers.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="number">10</span><span class="punct">./(</span> <span class="number">2</span> <span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="number">5</span>

 <span class="comment"># the lettuce gives the remainder of a division.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="number">10</span><span class="punct">.%(</span><span class="string"> 3 </span><span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="number">1</span>

 <span class="comment"># the bomb is for multiplication.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="number">10</span><span class="punct">.*(</span> <span class="number">3</span> <span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="number">30</span></code></pre></div>

	<p>Where it makes sense, you may choose to use math operators on some of your Classes.  Ruby uses these math operators on many of its own classes.  Arrays, for example, have a handful of math operators which you can see in the list of instance methods when you type: <code><span class="ident">ri</span> <span class="constant">Array</span></code>.</p>


<div class='example'><pre><code> <span class="comment"># the plus operator combines two arrays into a single array</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">[&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">W</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">E</span><span class="punct">&quot;]</span> <span class="punct">+</span> <span class="punct">[&quot;</span><span class="string">M</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">T</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">H</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">Y</span><span class="punct">&quot;]</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">W</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">E</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">M</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">T</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">H</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">Y</span><span class="punct">&quot;]</span>

 <span class="comment"># minus removes all items in the second array found in the first</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">[&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">W</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">E</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">M</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">T</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">H</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">Y</span><span class="punct">&quot;]</span> <span class="punct">-</span> <span class="punct">[&quot;</span><span class="string">W</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">T</span><span class="punct">&quot;]</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">E</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">M</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">H</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">Y</span><span class="punct">&quot;]</span>

 <span class="comment"># the multiplier repeats the elements of an array</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">[&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">W</span><span class="punct">&quot;]</span> <span class="punct">*</span> <span class="number">3</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">W</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">W</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">D</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">W</span><span class="punct">&quot;]</span></code></pre></div>

	<p>You may be wondering: what does this mean for math, though?  What if I add the number three to an array?  What if I add a string and a number?  <strong>How is Ruby going to react?</strong></p>


	<p>Please remember these operators are just methods.  But, since these operators <em>aren&#8217;t readable words</em>, it can be harder to tell what they do.  Use <code><span class="ident">ri</span></code>.  Often you&#8217;ll find that the operators are identical to other readable methods.  You can then choose to use the operator or the method. Whichever is clearer to you.</p>


<div class='example'><pre><code> <span class="comment"># divide with an operator method ...</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="number">10</span> <span class="punct">/</span> <span class="number">3</span>
   <span class="punct">=&gt;</span> <span class="number">3</span>

 <span class="comment"># ... or a readable method?</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="number">10</span><span class="punct">.</span><span class="ident">div</span> <span class="number">3</span>
   <span class="punct">=&gt;</span> <span class="number">3</span></code></pre></div>

	<p>And that&#8217;s how the Rabbit&#8217;s sword divides.</p>


	<h3>The Harsh Realities of Dwemthy&#8217;s Array <span class="caps">AWAIT YOU TO MASH YOU</span>!!</h3>


	<p>Once you&#8217;re done playchoking the last guy with his oxygen tube, it&#8217;s time to enter The Array.  I doubt you can do it.  You left your hatchet at home.  And I hope you didn&#8217;t use all your bombs on the easy guy.</p>


	<p>You have six foes.</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">IndustrialRaverMonkey</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">46</span>
   <span class="ident">strength</span> <span class="number">35</span>
   <span class="ident">charisma</span> <span class="number">91</span>
   <span class="ident">weapon</span> <span class="number">2</span>
 <span class="keyword">end</span>

 <span class="keyword">class </span><span class="class">DwarvenAngel</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">540</span>
   <span class="ident">strength</span> <span class="number">6</span>
   <span class="ident">charisma</span> <span class="number">144</span>
   <span class="ident">weapon</span> <span class="number">50</span>
 <span class="keyword">end</span>

 <span class="keyword">class </span><span class="class">AssistantViceTentacleAndOmbudsman</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">320</span>
   <span class="ident">strength</span> <span class="number">6</span>
   <span class="ident">charisma</span> <span class="number">144</span>
   <span class="ident">weapon</span> <span class="number">50</span>
 <span class="keyword">end</span>

 <span class="keyword">class </span><span class="class">TeethDeer</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">655</span>
   <span class="ident">strength</span> <span class="number">192</span>
   <span class="ident">charisma</span> <span class="number">19</span>
   <span class="ident">weapon</span> <span class="number">109</span>
 <span class="keyword">end</span>

 <span class="keyword">class </span><span class="class">IntrepidDecomposedCyclist</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">901</span>
   <span class="ident">strength</span> <span class="number">560</span>
   <span class="ident">charisma</span> <span class="number">422</span>
   <span class="ident">weapon</span> <span class="number">105</span>
 <span class="keyword">end</span>

 <span class="keyword">class </span><span class="class">Dragon</span> <span class="punct">&lt;</span> <span class="constant">Creature</span>
   <span class="ident">life</span> <span class="number">1340</span>     <span class="comment"># tough scales</span>
   <span class="ident">strength</span> <span class="number">451</span>  <span class="comment"># bristling veins</span>
   <span class="ident">charisma</span> <span class="number">1020</span> <span class="comment"># toothy smile</span>
   <span class="ident">weapon</span> <span class="number">939</span>    <span class="comment"># fire breath</span>
 <span class="keyword">end</span></code></pre></div>

	<p>These are the living, breathing monstrosities of Dwemthy&#8217;s Array.  I don&#8217;t know how they got there.  No one knows.  Actually, I&#8217;m guessing the <code><span class="constant">IntrepidDecomposedCyclist</span></code> rode his ten-speed.  But the others: <span class="caps">NO ONE</span> knows.</p>


	<p>If it&#8217;s really important for you to know, let&#8217;s just say the others were born there. Can we move on??</p>


	<p>As Dwemthy&#8217;s Array gets deeper, the challenge becomes more difficult.</p>


<div class='example'><pre><code> <span class="ident">dwary</span> <span class="punct">=</span> <span class="constant">DwemthysArray</span><span class="punct">[</span><span class="constant">IndustrialRaverMonkey</span><span class="punct">.</span><span class="ident">new</span><span class="punct">,</span>
                       <span class="constant">DwarvenAngel</span><span class="punct">.</span><span class="ident">new</span><span class="punct">,</span>
                       <span class="constant">AssistantViceTentacleAndOmbudsman</span><span class="punct">.</span><span class="ident">new</span><span class="punct">,</span>
                       <span class="constant">TeethDeer</span><span class="punct">.</span><span class="ident">new</span><span class="punct">,</span>
                       <span class="constant">IntrepidDecomposedCyclist</span><span class="punct">.</span><span class="ident">new</span><span class="punct">,</span>
                       <span class="constant">Dragon</span><span class="punct">.</span><span class="ident">new</span><span class="punct">]</span></code></pre></div>

	<p>Fight the Array and the monsters will appear as you go.  Godspeed and may you return with harrowing tales and nary an angel talon piercing through your shoulder.</p>


	<p>Start here:</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">r</span> <span class="punct">%</span> <span class="ident">dwary</span></code></pre></div>

	<p>Oh, and none of this &#8220;I&#8217;m too young to die&#8221; business.  I&#8217;m sick of that crap. I&#8217;m not going to have you insulting our undead young people.  They are our future. After our future is over, that is.</p>


	<p><img src="../images/wixl.dwemthy-3.gif" title="The rabbit has changed us." alt="The rabbit has changed us." /></p>


	<h3>The Making of Dwemthy&#8217;s Array</h3>


	<p>Fast forward to a time when the winds have calmed.   The dragon is vanquished.  The unwashed masses bow.  We love you. We are loyal to you.</p>


	<p>But what is this centipede nibbling in your eardrum?  You dig with your finger, but you can&#8217;t get him out!  Blasted!  It&#8217;s that infernal Dwemthy&#8217;s Array again.  <strong>Explain yourself Dwemthy!</strong></p>


	<p>Here, I shall unmask the Array itself for you.</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">DwemthysArray</span> <span class="punct">&lt;</span> <span class="constant">Array</span>
   <span class="keyword">alias</span> <span class="ident">_inspect</span> <span class="ident">inspect</span>
   <span class="keyword">def </span><span class="method">inspect</span><span class="punct">;</span> <span class="punct">&quot;</span><span class="string">#&lt;<span class="expr">#{ self.class }#{ inspect }</span>&gt;</span><span class="punct">&quot;;</span> <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">method_missing</span><span class="punct">(</span> <span class="ident">meth</span><span class="punct">,</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
     <span class="ident">answer</span> <span class="punct">=</span> <span class="ident">first</span><span class="punct">.</span><span class="ident">send</span><span class="punct">(</span> <span class="ident">meth</span><span class="punct">,</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
     <span class="keyword">if</span> <span class="ident">first</span><span class="punct">.</span><span class="ident">life</span> <span class="punct">&lt;=</span> <span class="number">0</span>
       <span class="ident">shift</span>
       <span class="keyword">if</span> <span class="ident">empty?</span>
         <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[Whoa.  You decimated Dwemthy's Array!]</span><span class="punct">&quot;</span> 
       <span class="keyword">else</span>
         <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">[Get ready. <span class="expr">#{ first.class }</span> has emerged.]</span><span class="punct">&quot;</span> 
       <span class="keyword">end</span>
     <span class="keyword">end</span>
     <span class="ident">answer</span> <span class="punct">||</span> <span class="number">0</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>By now, you&#8217;re probably feeling very familiar with inheritance.  The <code><span class="constant">DwemthysArray</span></code> class inherits from <code><span class="constant">Array</span></code> and, thus, behaves just like one.  For being such a mystery, it&#8217;s alarmingly brief, yeah?</p>


	<p>So it&#8217;s an Array.  Filled with monsters.  But what does this extra code do?</p>


	<h3>Inspect</h3>


	<p>The <code><span class="ident">inspect</span></code> method isn&#8217;t really a necessary part of Dwemthy&#8217;s Array.  It&#8217;s something Dwemthy added as a courtesy to his guests.  (Many call him twisted, many call him  austere, but we&#8217;d all be ignorant to go without admiring the footwork he puts in for us.)</p>


	<p>Every object in Ruby has an <code><span class="ident">inspect</span></code> method.  It is defined in the <code><span class="constant">Object</span></code> class, so it trickles down through the pedigree to every wee child object just born.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">o</span> <span class="punct">=</span> <span class="constant">Object</span><span class="punct">.</span><span class="ident">new</span>
   <span class="punct">=&gt;</span> <span class="comment">#&lt;Object:0x81d60c0&gt;</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">o</span><span class="punct">.</span><span class="ident">inspect</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">#&lt;Object:0x81d60c0&gt;</span><span class="punct">&quot;</span></code></pre></div>

	<p>Have you noticed this?  Whenever we create an object in <code><span class="ident">irb</span></code>, this noisy <code><span class="comment">#&lt;Object&gt;</span></code> verbage stumbles out!  It&#8217;s a little name badge for the object.  The <code><span class="ident">inspect</span></code> method creates that name badge.  The badge is just a string.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">class </span><span class="class">Rabbit</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="ident">attr_accessor</span> <span class="symbol">:slogan</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="keyword">def </span><span class="method">initialize</span> <span class="ident">s</span><span class="punct">;</span> <span class="attribute">@slogan</span> <span class="punct">=</span> <span class="ident">s</span><span class="punct">;</span> <span class="keyword">end</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="keyword">def </span><span class="method">inspect</span><span class="punct">;</span> <span class="punct">&quot;</span><span class="string">#&lt;<span class="expr">#{ self.class }</span> says '<span class="expr">#{ @slogan }</span>'&gt;</span><span class="punct">&quot;;</span> <span class="keyword">end</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">end</span>

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">class </span><span class="class">FakeRabbit</span> <span class="punct">&lt;</span> <span class="constant">Rabbit</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">end</span>

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="constant">Rabbit</span><span class="punct">.</span><span class="ident">new</span> <span class="punct">&quot;</span><span class="string">i blow'd the drgn's face off!!</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="comment">#&lt;Rabbit says 'i blow'd the drgn's face off!!'&gt;</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="constant">FakeRabbit</span><span class="punct">.</span><span class="ident">new</span> <span class="punct">&quot;</span><span class="string">Thusly and thusly and thusly...</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="comment">#&lt;FakeRabbit says 'Thusly and thusly and thusly...'&gt;</span></code></pre></div>

	<p>The thing is: <code><span class="ident">irb</span></code> is talking back.  Every time you run some code in <code><span class="ident">irb</span></code>, the <em>return value</em> from that code is inspected.  How handy.  It&#8217;s a little conversation between you and <code><span class="ident">irb</span></code>.  And <code><span class="ident">irb</span></code> is just reiterating what you&#8217;re saying so you can see it for your self.</p>


	<p>You could write your own Ruby prompt very easily:</p>


<div class='example'><pre><code> <span class="ident">loop</span> <span class="keyword">do</span>
   <span class="ident">print</span> <span class="punct">&quot;</span><span class="string">&gt;&gt; </span><span class="punct">&quot;</span> 
   <span class="ident">puts</span>  <span class="punct">&quot;</span><span class="string">=&gt; </span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">eval</span><span class="punct">(</span> <span class="ident">gets</span> <span class="punct">).</span><span class="ident">inspect</span>
 <span class="keyword">end</span></code></pre></div>

	<p>This prompt won&#8217;t let you write Ruby code longer than a single line.  It&#8217;s the essence of interactive Ruby, though.  How do you like that?  Two of your recently learned concepts have come together in a most flavorful way.  The <code><span class="ident">eval</span></code> takes the typed code and runs it. The response from <code><span class="ident">eval</span></code> is then inspected.</p>


	<p>Now, as you are fighting monsters in <code><span class="ident">irb</span></code>, Dwemthy&#8217;s Array will be inspected and replying with the monsters you have left to fight.</p>


	<p><img src="../images/wixl-5.gif" title="The foxes eat out." alt="The foxes eat out." /></p>


	<h3>Method Missing</h3>


	<p>Don&#8217;t you hate it when you yell &#8220;Deirdre!&#8221; and like ten people answer?  That <em>never</em> happens in Ruby.  If you call the <code><span class="ident">deirdre</span></code> method, only one <code><span class="ident">deirdre</span></code> method answers.  You can&#8217;t have two methods named the same.  If you add a second <code><span class="ident">deirdre</span></code> method, the first one disappears.</p>


	<p>You can, however, have a method which <strong>answers to many names</strong>.</p>


<div class='example'><pre><code> <span class="keyword">class </span><span class="class">NameCaller</span>
   <span class="keyword">def </span><span class="method">method_missing</span><span class="punct">(</span> <span class="ident">name</span><span class="punct">,</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">You're calling `</span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">name</span> <span class="punct">+</span> <span class="punct">&quot;</span><span class="string">' and you say:</span><span class="punct">&quot;</span> 
     <span class="ident">args</span><span class="punct">.</span><span class="ident">each</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">say</span><span class="punct">|</span> <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">  </span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">say</span> <span class="punct">}</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">But no one is there yet.</span><span class="punct">&quot;</span> 
   <span class="keyword">end</span>
   <span class="keyword">def </span><span class="method">deirdre</span><span class="punct">(</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Deirdre is right here and you say:</span><span class="punct">&quot;</span> 
     <span class="ident">args</span><span class="punct">.</span><span class="ident">each</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">say</span><span class="punct">|</span> <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">  </span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">say</span> <span class="punct">}</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">And she loves every second of it.</span><span class="punct">&quot;</span> 
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">(I think she thinks you're poetic.)</span><span class="punct">&quot;</span> 
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>When you call the method <code><span class="ident">deirdre</span></code> above, I&#8217;m sure you know what will happen.  Deirdre will love every second of it, you and your dazzling poetry.</p>


	<p>But what if you call <code><span class="ident">simon</span></code>?</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="constant">NameCaller</span><span class="punct">.</span><span class="ident">new</span><span class="punct">.</span><span class="ident">simon</span><span class="punct">(</span> <span class="punct">'</span><span class="string">Hello?</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Hello? Simon?</span><span class="punct">'</span> <span class="punct">)</span>
 <span class="constant">You</span><span class="punct">'</span><span class="string">re calling `simon</span><span class="punct">'</span> <span class="keyword">and</span> <span class="ident">you</span> <span class="ident">say</span><span class="punct">:</span>
   <span class="constant">Hello</span><span class="punct">?</span>
   <span class="constant">Hello</span><span class="punct">?</span> <span class="constant">Simon</span><span class="punct">?</span>
 <span class="constant">But</span> <span class="ident">no</span> <span class="ident">one</span> <span class="ident">is</span> <span class="ident">there</span> <span class="ident">yet</span><span class="punct">.</span></code></pre></div>

	<p>Yes, <code><span class="ident">method_missing</span></code> is like an answering machine, which intercepts your method call.  In Dwemthy&#8217;s Array we use call forwarding, so that when you attack the Array, it passes that attack on straight to the first monster in the Array.</p>


<div class='example'><pre><code> <span class="keyword">def </span><span class="method">method_missing</span><span class="punct">(</span> <span class="ident">meth</span><span class="punct">,</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
   <span class="ident">answer</span> <span class="punct">=</span> <span class="ident">first</span><span class="punct">.</span><span class="ident">send</span><span class="punct">(</span> <span class="ident">meth</span><span class="punct">,</span> <span class="punct">*</span><span class="ident">args</span> <span class="punct">)</span>
   <span class="comment"># ... snipped code here ...</span>
 <span class="keyword">end</span></code></pre></div>

	<p>See!  See!  That skinny little <code><span class="ident">method_missing</span></code> passes the buck!</p>

    
    
        
        <a name="section4" />
        <h2>4. So, Let's Be Clear: The Porcupine Is Now To The Sea</h2>

        <p><img src="../images/porcupine-2.gif" title="The porcupine and his kite." alt="The porcupine and his kite." /></p>

    
    
        
        <a name="section5" />
        <h2>5. Walking, Walking, Walking, Walking and So Forth</h2>

        <p>The evening grew dark around the pair of foxes.  They had wound their way through alleys packed with singing possums, and streets where giraffes in rumpled sportscoats bumped past them with their briefcases.  They kept walking.</p>


	<p>And now the stores rolled shut their corrugated metal lids.   Crickets crawled out from the gutters and nudged at the loose change.</p>


	<p><img src="../images/wixl-6.gif" title="Why such hard feelings?" alt="Why such hard feelings?" /></p>


	<p>&#8220;Anyway, you must admit he&#8217;s a terrible President,&#8221; said Fox Small. <em>&#8220;Why</em> does President Marcos have a rabbit as Vice President of the Foxes.&#8221;</p>


	<p>&#8220;The Vice President?  The rabbit with the <em>eyebrows</em>?&#8221;</p>


	<p>&#8220;No, the rabbit with the <strong>huge sausage lips</strong>,&#8221; said Fox Small.</p>


	<p>But their conversation was abruptly interupted by a freckly cat head which popped from the sky just above the sidewalk.</p>


	<p><img src="../images/wixl.blix-1.gif" title="At least they're still in the book..." alt="At least they're still in the book..." /></p>


	<p>What is this about?!</p>


	<p><img src="../images/wixl-14.gif" title="Will the book finish?" alt="Will the book finish?" /></p>


	<p>Oh, come on.  This is rich.  More meta.</p>


	<p>I&#8217;m not going to bother illustrating this discussion Blixy had with the foxes at this point! It&#8217;s all a <strong>bunch of <em>conjecture</em></strong>.  <em><span class="caps">HOW</span></em> can they presume to know the landscape of my family drama? I love my sister.  For a long time, I <em>worshipped</em> her. (This is my sister Quil.)</p>


	<p>I admit that there was a pretty painful day a few months ago and I kind of freaked out.  I was laid out on the long patio chair by the pool in my mom&#8217;s backyard.  I had a Dr. Pepper and a bit of german chocolate cake.  I was eating with a kid fork.  Everything else was in the dishwasher, that&#8217;s all they had.  Three prongs.</p>


	<p>My mom started talking about Quil.  All about how much money she was blowing on pants and purses. A five-hundred dollar purse.  And then she said, &#8220;She&#8217;s losing it. She sounded totally high on the phone.&#8221; (She nailed it on the head, Quil was smoking dope and loving it.)</p>


	<p>So I&#8217;d been noticing how observant my mom could be.  That&#8217;s why, when she said, &#8220;I actually think she&#8217;s on cocaine,&#8221; I <em>physically</em> stood up and chucked my soda across the yard.</p>


	<p>It sailed off into the woods somewhere.  We had been talking awhile, so it was dark when the can flew. I paced a bit.  And then I screamed at the top of my lungs.</p>


	<p>My uncle Mike was standing there with the glass door open, staring at me.  He said something totally nervous like, &#8220;Oh, okay.  Well, I&#8217;ll&#8212;&#8221;  And the tea in his glass was swishing back and forth, sloshing all over.  He disappeared.  He&#8217;s not very good at saying things to people.  He&#8217;s more of a whistler.  And resonant.</p>


	<p><img src="../images/wixl.blix-2.gif" title="Moving along." alt="Moving along." /></p>


	<p>So, to be completely honest, yes, I got a little mad.  I got mad.  You know.  I dealt with it. Quil calls me regularly.  For some stupid reason, I rarely call her.</p>


	<p>Plus, she didn&#8217;t end up killing herself.  So it&#8217;s just not an issue.  Who knows if it was real. She just had a lot of vodka.  And she&#8217;s little.  So it was just scary to see Quil guzzling it down like that. I mean forcing it down.</p>


	<p>But why talk about it?  It&#8217;ll just make her feel like I&#8217;m disappointed.  Or like I&#8217;m a jerk.</p>


	<p>Well, I got off track there a bit.  Where was I?  Blix is basically helping the foxes around, getting them on the trail of their truck.  Yeah, back to all that.</p>


	<p><img src="../images/wixl-3.gif" title="Frogs who save seats on the bus." alt="Frogs who save seats on the bus." /></p>


	<p>&#8220;We can&#8217;t squeeze on to this bus,&#8221; said the smallest fox.</p>


	<p>&#8220;Guys, walk on up,&#8221; said Blix.  &#8220;What&#8217;s the hold up?  Oh, the frogs.  Yeah, just squeeze through.&#8221; Blixy pushed from behind.</p>


	<p>&#8220;Hey,&#8221; said the Tall Fox.  &#8220;I&#8217;m crammed on this little step!  Somebody move!&#8221;</p>


	<p>&#8220;Did you get through&#8212;young fox??&#8221; said the cat.</p>


	<p>&#8220;No,&#8221; said Fox Small, &#8220;can&#8217;t you see?  The driver keeps shaking his head and it&#8217;s <em>really</em> making me nervous.  I don&#8217;t think he wants us on.&#8221;</p>


	<p>&#8220;Go,&#8221; said Blix.  He stepped down from his step and walked around the bus, peering through the plexiglass windows.  &#8220;Well, I don&#8217;t know, guys.  I dunno.  I guess it&#8217;s got a lot of frogs.&#8221;  He pounded on the window.  &#8220;Hey!  Move over!&#8221;</p>


	<p>And that&#8217;s the reality of riding intercity transit in Wixl.  It&#8217;s terribly competitive.  The morning bus is so crowded that most white collar animals get frogs to hold their seat through the nighttime. For whatever reason, it works.  It&#8217;s become this staple of their workflow and their economy.</p>


	<p>If you can muster up a bit of imagination, you can see a <strong>percent sign</strong> as a frog&#8217;s slanted face. Got the picture in your head?  Now let me show you frogs that camp out inside strings.</p>


<div class='example'><pre><code> <span class="comment"># The %s format is for placing full strings.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">Seats are taken by %s and %s.</span><span class="punct">&quot;</span> <span class="punct">%</span> <span class="punct">['</span><span class="string">a frog</span><span class="punct">',</span> <span class="punct">'</span><span class="string">a frog with teeth</span><span class="punct">']</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Seats are taken by a frog and a frog with teeth.</span><span class="punct">&quot;</span> 

 <span class="comment"># The %d format is for placing numbers, while the %f format is for</span>
 <span class="comment"># floats (decimal numbers).</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">frogs</span> <span class="punct">=</span> <span class="punct">[</span><span class="number">44</span><span class="punct">,</span> <span class="number">162.30</span><span class="punct">]</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">stats</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">Frogs have filled %d seats and paid %f blue crystals.</span><span class="punct">&quot;</span> 
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">stats</span> <span class="punct">%</span> <span class="ident">frogs</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Frogs have filled 44 seats and paid 162.30 blue crystals.</span><span class="punct">&quot;</span> 

 <span class="comment"># Formatting is flexible with types, you can pass in strings</span>
 <span class="comment"># and format them like numbers.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">frogs</span> <span class="punct">=</span> <span class="punct">['</span><span class="string">44</span><span class="punct">',</span> <span class="punct">'</span><span class="string">162.30</span><span class="punct">']</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">stats</span> <span class="punct">%</span> <span class="ident">frogs</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Frogs have filled 44 seats and paid 162.30 blue crystals.</span><span class="punct">&quot;</span></code></pre></div>

	<p>What you are seeing above uses the <code>%</code> method in the <code><span class="constant">String</span></code> class. This method takes <strong>a string</strong> and <strong>an array</strong> and slurps them in together to create a new string.  The items from the list are yanked out (in order) and placed in their saved seats.  It&#8217;s the open of the business day and the frogs have done their job.</p>


<div class='example'><pre><code> <span class="comment"># See, here's the String#% method called like other methods.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">Please move over, %s.</span><span class="punct">&quot;.%(</span><span class="string"> 'toothless frog' </span><span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Please move over, toothless frog</span><span class="punct">&quot;</span> 

 <span class="comment"># Now let's call it the prettier way, with the percent sign</span>
 <span class="comment"># right between the string and the array.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">Here is your 1098 statement for the year, %s.</span><span class="punct">&quot;</span> <span class="punct">%</span> <span class="punct">['</span><span class="string">teeth frog</span><span class="punct">']</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Here is your 1098 statement for the year, teeth frog.</span><span class="punct">&quot;</span></code></pre></div>

	<p>This is also available as the <code><span class="constant">Kernel</span><span class="punct">::</span><span class="ident">format</span></code> method or <code><span class="constant">Kernel</span><span class="punct">::</span><span class="ident">sprintf</span></code> method.  (In the C language, there is a <code><span class="ident">sprintf</span></code> method which operates just like this.)</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">format</span> <span class="punct">&quot;</span><span class="string">Frogs are piled %d deep and travel at %d mph.</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">5</span><span class="punct">,</span> <span class="number">56</span><span class="punct">]</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Frogs are piled 5 deep and travel at 56 mph.</span><span class="punct">&quot;</span></code></pre></div>

	<p>For the most part, you&#8217;ll only need <code>%s</code> (strings), <code>%d</code> (integer numbers) or <code>%f</code> (float numbers) format specifiers.  The <code>%p</code> placeholder will run <code><span class="ident">inspect</span></code> on an object.</p>


	<p>Yeah, so, frog formatting is really handy for building strings that are assembled from different kinds of data.  You can learn all the various kinds of format specifiers by reading the <code><span class="ident">ri</span> <span class="ident">sprintf</span></code> page.  I&#8217;m just going to give you a few quick pointers.</p>


	<p>Let&#8217;s say you have the array but you want the items to appear in <strong>a different order</strong> in the string.  In such a situation, you can identify specific items by placing a number (<code><span class="number">1</span><span class="global">$</span></code> for the first item, <code><span class="number">2</span><span class="global">$</span></code> for the second, and so on) right after the percent sign.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">This bus has %1$d more stops before %2$d o'clock.  That's %1$d more stops.</span><span class="punct">&quot;</span> <span class="punct">%</span> <span class="punct">[</span><span class="number">16</span><span class="punct">,</span> <span class="number">8</span><span class="punct">]</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">This bus has 16 more stops before 8 o'clock.  That's 16 more stops.</span><span class="punct">&quot;</span></code></pre></div>

	<p>The second tip I have for you is that you can allot a certain number of characters for each item, a width.  And if an item is smaller than the width, extra spaces will be used before the item.  To pad it. If the width is a negative number, the item will be forced to left and the padding will come after it.</p>


<div class='example'><pre><code> <span class="comment"># Give one item 30 characters of width</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">In the back of the bus: %30s.</span><span class="punct">&quot;</span> <span class="punct">%</span> <span class="punct">['</span><span class="string">frogs</span><span class="punct">']</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">In the back of the bus:                          frogs.</span><span class="punct">&quot;</span> 

 <span class="comment"># Give one left-justified item 30 characters of width</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">At the front of the bus: %-30s.</span><span class="punct">&quot;</span> <span class="punct">%</span> <span class="punct">['</span><span class="string">frogs</span><span class="punct">']</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">At the front of the bus: frogs                         .</span><span class="punct">&quot;</span></code></pre></div>

	<p>Fox Small kept looking up at the bus driver.  Remember, he wouldn&#8217;t enter the bus!</p>


	<p>&#8220;What&#8217;s the deal?&#8221; said Fox Tall.  &#8220;Can&#8217;t you just get on and we&#8217;ll just stand in the aisle?&#8221;</p>


	<p>&#8220;You really want to get on this bus?  That driver has no hands,&#8221; said Fox Small, speaking close and hushed to Fox Tall, &#8220;and all he has, instead of hands, are sucker cups.&#8221;</p>

    
    
        
        <div class="sidebar">
        <h1>sidebar!</h1>
        
        <h2>More From The Chilling Ongoing Preview of The Scarf Eaters</h2>
        

        <p>(<em>from Chapter <span class="caps">XII</span>: Thank Heaven for Little Men</em>.)</p>


	<p>&#8220;Close the door,&#8221; Spencer repeated, but Lara&#8217;s hand trembled and she fumbled sloppily at the latch. Her dad hadn&#8217;t taught her to close doors like this one.</p>


	<p>&#8220;Yes, it&#8217;s an unusual door,&#8221; said Brent.  He walked over and closed the door for her. Then, he held her hand and looked into her eyes.  His eyes lit up like huge matchsticks that would be too huge to be practical.  &#8220;It&#8217;s an unusual handle, which ensures that those who don&#8217;t eat scarves stay out.&#8221;</p>


	<p>&#8220;Sit down, everyone,&#8221; Spencer demanded, as he bounded across the room and took command. &#8220;I command this organization,&#8221; he stated.  &#8220;The secret organization of The Scarf Eaters!&#8221;</p>


	<p>The torches encircling the room blazed like invincibly huge matches and the handful of teenagers sat.  Except for Spencer who stood high and mighty, drawing all the oxygen in the entire room into his nostrils before speaking.</p>


	<p>&#8220;One of us,&#8221; he said, dramatically and invincibly, &#8220;is missing!&#8221;</p>


	<p>The entire room gasped, which also used oxygen.  The room was abuzz.  &#8220;Who?&#8221;  &#8220;How?&#8221; &#8220;Who was it?&#8221;  Nobody knew.  Except for Spencer, who lept across the room and took charge.</p>


	<p>&#8220;Our dear friend Steve Bridell has been stolen from us,&#8221; announced Spencer in a deafeningly loud voice, as if thousands of giant matchsticks were struck against a brittle surface in unison amidst a pile of oxygen.  &#8220;Steve Bridell.  Do any of you know Steve Bridell?&#8221;</p>


	<p>The hall was silent.</p>


	<p>Spencer continued.  &#8220;Steve Bridell was an incredible resource and you all knew him and loved him.  He carved this enormous wooden man we use as our podium.&#8221;  Spencer pointed. &#8220;He also made the set of wooden cymbals that are back in our instrument closet right now.&#8221;</p>


	<p>Some of the audience stood.</p>


	<p>&#8220;Wait,&#8221; instructed Spencer.  &#8220;Don&#8217;t go back there.   I&#8217;ve already checked.  The cymbals are gone!&#8221;</p>
        <h1>sidebar!</h1>
        </div>

    
    

        <p>&#8220;So what?  You don&#8217;t think animals with tentacles can drive?&#8221;</p>


	<p>&#8220;Well, not only is he going to flub up the steering wheel but he has all these legs all over the foot pedals.  This is not smart.  Let&#8217;s get another bus.  Come on.&#8221;</p>


	<p>&#8220;You know, he&#8217;s probably been driving like that all day.  Is he really going to start crashing at this point in his career?&#8221;</p>


	<p>&#8220;Buses do crash,&#8221; said Fox Small.  &#8220;Some do.  This smells crashworthy.&#8221;</p>


	<p>&#8220;Sheer doo-doo!&#8221;  And Fox Tall yelled to the driver, &#8220;Hey, cabby, how long have you been driving this bus for?&#8221;</p>


	<p>The bus driver peered over darkly under his cap and started to turn toward them, but his tentacles were stuck to the wheel.  He jerked swiftly at his forelegs and, failing their release, he turned to the wheel and focused his energies on milking his glands for some slicker secretions.  Bubbles of mucus oozed.</p>


	<p>&#8220;Let&#8217;s get outta here,&#8221; said Fox Tall and the two ran off into the street, slamming right into the cat Blix.</p>


	<p>&#8220;Alright, well, the bus is full,&#8221; said Blix.  &#8220;I don&#8217;t know why the driver stopped if he knew the bus was crammed with hoppers.&#8221;</p>


	<p>&#8220;We&#8217;re thinking he was about to crash into us,&#8221; said Fox Tall, &#8220;and he opened the door to make it look like a planned route stop.&#8221;</p>


	<p>&#8220;Keep in mind, Blix, we hadn&#8217;t really discussed that possibility out loud, so I haven&#8217;t had a chance to formally agree,&#8221; said Fox Small.  &#8220;Nevertheless, it sounds rational to me.&#8221;</p>


	<p>&#8220;I&#8217;m thinking all the buses are going to be full like this.&#8221;  Blix bit his lip, thinking and flicking his eyes about.  &#8220;Let&#8217;s just-<del>&#8221;  He pointed down the circuitry of apartment buildings that wound to the south.  &#8220;But maybe</del>-&#8221;  He looked up and surveyed the stars, scratching his head and counting the constellations with very small poking motions from the tip of his finger.</p>


	<p>&#8220;Are you getting our bearings from the stars and planets?&#8221; asked Fox Small.</p>


	<p>Blix didn&#8217;t speak, he ducked off to the north through a poorly laid avenue back behind the paint store. But before we follow them down that service road, Smotchkkiss, I have one more frog for you, perched on a long lilypad that stretches out to hold anything at all.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">cat</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">Blix</span><span class="punct">&quot;</span> 
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Does <span class="expr">#{ cat }</span> see what's up?  Is <span class="expr">#{ cat }</span> aware??</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Does Blix see what's up?  Is Blix aware??</span><span class="punct">&quot;</span></code></pre></div>

	<p>The little frogs from earlier (<code>%s</code> or <code>%d</code>) were only placeholders for single strings.  Saving places in the string.</p>


	<p>The lilypads above start with a flower bud, the <strong>octothorpe</strong>.  You&#8217;ve also seen it as a pound sign on telephones.  After the flower bud, two leaves form the edges of the lilypad.  The leaves are <strong>curly braces</strong>, also seen many times before as the <em>crab pincers</em> for a code block.</p>


	<blockquote>
		<p>An empty lilypad <code><span class="punct">&quot;</span><span class="string"><span class="expr">#{}</span></span><span class="punct">&quot;</span></code> becomes an empty string <code><span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;</span></code>.</p>
	</blockquote>


	<p>When the lilypad is found in a <strong>double-quoted</strong> string, Ruby runs any code found in between the two leaves of the lilypad.  The lilypad is lifted out and the result of the code is placed there in the string.  This lilypad swap is called <em>string interpolation</em>.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">fellows</span> <span class="punct">=</span> <span class="punct">['</span><span class="string">Blix</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Fox Tall</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Fox Small</span><span class="punct">']</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Let us follow <span class="expr">#{ fellows.join ' and ' }</span> on their journey.</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Let us follow Blix and Fox Tall and Fox Small on their journey.</span><span class="punct">&quot;</span></code></pre></div>

	<p>The lilypad is very durable and can hold any kind of code inside.  Above we are using <code><span class="constant">Array</span><span class="comment">#join</span></code>, but you can do anything you like inside.  Call object methods, conditional <code><span class="keyword">if</span></code> or <code><span class="keyword">case</span></code> statements, even define classes.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">blix_went</span> <span class="punct">=</span> <span class="symbol">:north</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Blix didn't speak, he ducked off to the <span class="expr">#{ blix_went }</span> through <span class="expr">#{
             if blix_went == :north
               'a poorly laid avenue behind the paint store'
             elsif blix_went == :south
               'the circuitry of apartment buildings'
             else
               '... well, who knows where he went.'
             end }</span>.  But before we follow them...</span><span class="punct">&quot;</span> 
 <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Blix didn't speak, he ducked off to the north through a poorly laid avenue
     behind the paint store.  But before we follow them...</span><span class="punct">&quot;</span></code></pre></div>

	<p>The foxes followed Blixy off behind the paint store and down the cracked, uneven asphalt. All of the stores on the dilapidated lane leaned at angles to each other.  In some places, slabs of sidewalk jutted up from the ground, forming a perilous walkway, a disorderly stack of ledges.  Almost as if the city planners had hoped to pay tribute to the techtonic plates.  One small drug store had slid below the surface, nearly out of eyesight.</p>


	<p>Truly, it was colorful, though.  The paint store had been tossing out old paints directly onto its neighbors.  The shops nearest the paint store were clogged with hundreds of colors, along the windowsills and in the rain gutters.  Yes, on the walls and pavement.</p>


	<p>Basically, beginning with the back porch of the paint store, the avenue erupted into a giant incongruous and poorly-dyed market.</p>


	<p>Further down, a dentist&#8217;s office was primed with red paint and, over that, a fledgling artist had depicted a large baby who had fallen through a chimney and arrived in a fireplace full of soot. Crude black strokes marked the cloud of ashes raised during impact, easily mistaken for thick hair on the child&#8217;s arms and back.  The child looked far too young to have much hair, but there they were: rich, blonde curls which toppled liberally from the child&#8217;s head.  Under the child&#8217;s legs was painted the word <em><span class="caps">BREWSTER</span></em>.</p>


	<p>The same artist had hit the library next store and had hastily slapped together a mural of a green sports car being pulled from the mud by a team of legless babies tugging with shiny chains. Again, the drastically blonde curls!</p>


	<p>&#8220;I need answers,&#8221; said the Fox Tall, who had ground to a halt in front of the scenery.</p>


	<p>&#8220;I&#8217;m starting to believe there&#8217;s no such thing,&#8221; said Fox Small.  &#8220;Maybe these are the answers.&#8221;</p>


	<p>&#8220;Brewster?&#8221; said Fox Tall.  He walked nearer to the library and touched the cheek of one of the legless children who was closer in perspective.  The child&#8217;s cheek appeared to contain a myriad of jawbones.</p>


	<p>Blix was another two houses down, navigating through the askew brickwork, the paved gully that led to <em>R.K.&#8217;s Gorilla Mint</em>, as the metallic sticker on the door read.  The building was plastered with miniature logos for the variety of payment options and identification acceptable at <em>R.K.&#8217;s Gorilla Mint</em>.  Even the bars over the window were lined with insurance disclosures and security warnings and seals of government authorization, as well as addendums to all of these, carbon paper covering stickers covering torn posters and advertising.  And all mingled with paint splashes that intruded wherever they pleased.</p>


	<p><img src="../images/wixl-9.gif" title="R.K.'s Gorilla Mint." alt="R.K.'s Gorilla Mint." /></p>


	<p>&#8220;I like the way the fresh paper feels against my tongue,&#8221; said the gorilla at the counter. His fingers rubbed quietly against the bills.  He drew his face near to the fanned currency and whisked his nose along the pulpy cash.</p>


	<p>&#8220;Is R.K. in this evening?&#8221; asked Blix.</p>


	<p>&#8220;R.K. is not,&#8221; said the gorilla cashier.  He turned to the three travellers and spread his money out on the counter&#8217;s surface, evenly spacing them apart and lining up all the edges neatly.  &#8220;Now, which one of these do you think is worth the most?&#8221;</p>


	<p>The foxes looked over the different bills and Fox Small muttered to himself, &#8220;Well, maybe&#8212;no, but I&#8217;ll bet&#8212;Wait, does one of these have bananas on it?  &#8216;Cause that one&#8212;nope, no fruit or rope swings or&#8212;Terrible, this is difficult!&#8221;  And in a lower voice, &#8220;So difficult to read.  What does this one say?  Symbols or something? If all these bills have are symbols, it&#8217;s going to be impossible for us to figure out which one is of the greatest value.&#8221;</p>


	<p>&#8220;That&#8217;s why I said, &#8216;<em>Guess</em>.&#8217;&#8221;  The gorilla tapped each bill in order.  &#8220;See, you&#8217;ve got a 1 in 5 chance.&#8221;</p>


	<p>&#8220;Unless the symbols mean something,&#8221; said Fox Tall.  &#8220;Unless we can figure it out.&#8221;</p>


	<p>&#8220;We can figure it out,&#8221; said Fox Small.</p>


	<p>&#8220;No,&#8221; said the gorilla.  &#8220;The symbols are meaningless.&#8221;</p>


	<p>&#8220;Whoever created the money intended some meaning for them,&#8221; said Fox Small.  &#8220;Why use <em>this</em> symbol?&#8221;  He pointed to an ampersand printed in dark ink.</p>


	<p>&#8220;Yeah, we saw you sniffing the money and fantasizing about it back there,&#8221; said Fox Tall.  &#8220;I&#8217;ll bet these symbols mean all kinds of things to you!&#8221;</p>


	<p>&#8220;No, I don&#8217;t think so,&#8221; said the gorilla.</p>


	<p>If I can weigh in at this point, I think the symbols do have meaning.  They may not be <em>loaded</em> with meaning, it may not be oozing out through the cracks, but I&#8217;m sure there&#8217;s a sliver of meaning.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$:</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">/usr/lib/ruby/site_ruby/1.8</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">/usr/lib/ruby/site_ruby/1.8/i686-linux</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">/usr/lib/ruby/site_ruby</span><span class="punct">&quot;,</span> 
       <span class="punct">&quot;</span><span class="string">/usr/lib/ruby/1.8</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">/usr/lib/ruby/1.8/i686-linux</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">.</span><span class="punct">&quot;]</span></code></pre></div> 

	<p>Variables which start with the American cash sign are global variables.  They can be seen from anywhere in the program, <strong>from inside any scope</strong>.  (Dr. Cham used this variable while snooping around The Originals&#8217; computer bay.)</p>


	<p>So why does the <strong>cash sign followed by a colon</strong> represent an array of <strong>all directories where Ruby will search when you try to load a file with <code><span class="ident">require</span></code></strong>?  The cash sign means &#8220;global.&#8221;  But why the colon?</p>


	<p>Historically, on many operating systems, a list of directories contains colons which separated each entry.  I like to see the colon as a pair of eyes, scanning the directories for files.  We store our lookout list behind the eyes.</p>


	<p>Here&#8217;s a few more special global variables:</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$&quot;</span>      <span class="comment"># The $&quot; variable contains all files which have been loaded with `require'</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">irb.rb</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">e2mmap.rb</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">irb/init.rb</span><span class="punct">&quot;,</span> <span class="punct">...</span> <span class="punct">&quot;</span><span class="string">rbconfig.rb</span><span class="punct">&quot;]</span>
              <span class="comment"># These files are stored somewhere else, but their code is being used</span>
              <span class="comment"># in this program.  Much like quoting someone else's work -- these are the</span>
              <span class="comment"># footnotes -- hence the double-quote.</span>

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$0</span>      <span class="comment"># The $0 variable contains the running program's filename.</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">irb</span><span class="punct">&quot;</span>   <span class="comment"># A zero can be considered the beginning of a number count.</span>
              <span class="comment"># This variable answers the question, &quot;Where did this program begin?&quot; </span>

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$*</span>      <span class="comment"># The $* variable contains all the arguments passed into a program.</span>
   <span class="punct">=&gt;</span> <span class="punct">['</span><span class="string">--prompt</span><span class="punct">',</span> <span class="punct">'</span><span class="string">simple</span><span class="punct">']</span>
              <span class="comment"># This one is easy to remember, if you remember that Ruby methods</span>
              <span class="comment"># also use the asterisk to capture arguments into an array.</span>

 <span class="comment"># The $! contains the current exception raised.</span>
 <span class="comment"># The exclamation indicates a state of alarm.  An exception!</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">begin</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="keyword">raise</span> <span class="constant">TypeError</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">I don't believe this information.</span><span class="punct">&quot;</span> 
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">rescue</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="ident">p</span> <span class="global">$!</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">end</span>
   <span class="punct">=&gt;</span> <span class="comment">#&lt;TypeError: I don't believe this information.&gt;</span>

 <span class="comment"># The $@ contains the current backtrace, if an exception was raised.</span>
 <span class="comment"># The backtrace shows were Ruby was _at_ when the exception fired.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">begin</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="keyword">raise</span> <span class="constant">TypeError</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">I don't believe this information.</span><span class="punct">&quot;</span> 
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">rescue</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="ident">p</span> <span class="global">$@</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">end</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">(irb):25:in `irb_binding'</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">/usr/lib/ruby/1.8/irb/workspace.rb:52:in `irb_binding'</span><span class="punct">&quot;,</span> 
       <span class="punct">&quot;</span><span class="string">/usr/lib/ruby/1.8/irb/workspace.rb:52</span><span class="punct">&quot;]</span></code></pre></div>

	<p>&#8220;I don&#8217;t remember you.&#8221;  Blix looked at the gorilla with great interest. &#8220;Are you one of R.K.&#8217;s kids or something?&#8221;</p>


	<p>&#8220;Oh, come on!&#8221; said Fox Small, holding up a bill with an exclamation mark on it up to the gorilla&#8217;s nose. &#8220;Don&#8217;t tell me this means <em>nothing</em> to you!  This one is probably <em>really important</em> since it has an exclamation on it.  Maybe it pays for emergency stuff!  Hospital bills or something!&#8221;</p>


	<p><strong>&#8220;Yeah, surgery!&#8221;</strong> said Fox Tall.</p>


	<p>The gorilla looked at the foxes with disgust from under the brim of his cap.  &#8220;No, you&#8217;re wrong.  You can&#8217;t pay for surgeries with that.&#8221;</p>


	<p>&#8220;But you see our point,&#8221; said the small fox.  He grabbed some of the other bills. &#8220;And you say this bill <em>cannot</em> pay for surgeries?  Well that sounds like it has a specific <em>non-surgery-related</em> purpose.  Now, the question mark one.  Oh, what would that one be for?&#8221;</p>


	<p>&#8220;Hey, give me those,&#8221; the gorilla snatched at the bills over the counter, but  his long thumb kept getting in the way and every time he thought he had grabbed bills,  it turned out he had only grabbed his long thumb.</p>


	<p>&#8220;Hey, hey, look, he&#8217;s mad,&#8221; said Fox Tall, happily clapping.  &#8220;I wonder why.  Did you notice how mad he started getting once we mentioned all these interesting meanings?  <strong>We&#8217;re on to you!  We figured out your game so fast!&#8221;</strong></p>


	<p>&#8220;We totally did!&#8221; said Fox Small, one of his elbows caught in the grip of the gorilla, the other arm waving a bill that featured an underscore. &#8220;This one&#8217;s for buying floor supplies, maybe even big rolls of tile and linoleum.&#8221;</p>


	<p>&#8220;See,&#8221; said Fox Tall, working to pry the gorilla&#8217;s fingers free, &#8220;we just have to figure out which is more expensive: surgery or linoleum!  This is <em>so easy!&#8221;</em></p>


	<p><strong>&#8220;NO IT&#8217;S <span class="caps">NOT</span>!&#8221;</strong> yelled the gorilla, yanking at the smaller fox and battering the fox with his palms.  <strong>&#8220;YOU <span class="caps">DON</span>&#8217;T <span class="caps">KNOW ANYTHING ABOUT MONKEY MONEY</span>!!  <span class="caps">YOU DON</span>&#8217;T <span class="caps">EVEN</span> <em><span class="caps">HAVE</span></em> YOUR <span class="caps">OWN KINDS OF MONEY</span>!!&#8221;</strong></p>


	<p>&#8220;We could <em>easily</em> have our own kinds of money!&#8221; said Fox Tall, taking the chimp&#8217;s hat and tossing it to the back of the room, where it sailed behind a wall of safety deposit boxes.  &#8220;And&#8212;<em>your hat is outta here!</em>&#8220;</p>


	<p>&#8220;Come on, give him back his bills,&#8221; said Blix, waving his arms helplessly from the sidelines.  &#8220;We could really use this guy&#8217;s help.&#8221;</p>


	<p>&#8220;Stop hitting me!&#8221; screamed the littlest fox.  &#8220;I&#8217;ve almost figured out this one with the dots on it!!&#8221;</p>


	<p>Suddenly, with great precision and without warning, Fox Tall grabbed the monkey&#8217;s nose and slammed his face down against the counter.  The pens and inkpads on its surface rattled and &#8220;Bam!&#8221; said the fox.  The gorilla&#8217;s eyes spun sleepily as his arms&#8230; then his neck&#8230; then his head slithered to the floor behind the counter.</p>


	<p>Here are a few more global variables you might care to use:</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$/</span>      <span class="comment"># The $/ is the line separator, it is normally set to \n, which represents _Enter_</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span></span><span class="punct">&quot;</span>    <span class="comment"># or &quot;end of line&quot;.  The slash represents a sword slashing lines in a file.</span>

 <span class="comment"># The line separator controls how methods like each_line or readlines breaks up strings.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">Jeff,Jerry,Jill<span class="escape">\n</span>Michael,Mary,Myrtle</span><span class="punct">&quot;.</span><span class="ident">each_line</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">names</span><span class="punct">|</span> <span class="ident">p</span> <span class="ident">names</span> <span class="punct">}</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Jeff,Jerry,Jill<span class="escape">\n</span></span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Michael,Mary,Myrtle</span><span class="punct">&quot;</span> 

 <span class="comment"># If you change the line separator, you change how many methods work, such as each_line.</span>
 <span class="comment"># See what happens when I change the line separator to a comma.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$/</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">,</span><span class="punct">'</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">Jeff,Jerry,Jill<span class="escape">\n</span>Michael,Mary,Myrtle</span><span class="punct">&quot;.</span><span class="ident">each_line</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">names</span><span class="punct">|</span> <span class="ident">p</span> <span class="ident">names</span> <span class="punct">}</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Jeff,</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Jerry,</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Jill<span class="escape">\n</span>Michael,</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Mary,</span><span class="punct">&quot;</span> 
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Myrtle</span><span class="punct">&quot;</span> 

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$,</span>     <span class="comment"># The $, variable is the join separator, used when joining strings with</span>
   <span class="punct">=&gt;</span> <span class="constant">nil</span>    <span class="comment"># Array#join or Kernel::print.  The comma is a common join character.</span>

 <span class="comment"># The join separator is normally empty.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">['</span><span class="string">candle</span><span class="punct">',</span> <span class="punct">'</span><span class="string">soup</span><span class="punct">',</span> <span class="punct">'</span><span class="string">mackarel</span><span class="punct">'].</span><span class="ident">join</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">candlesoupmackarel</span><span class="punct">&quot;</span> 
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$,</span> <span class="punct">=</span> <span class="punct">'</span><span class="string"> * </span><span class="punct">';</span> <span class="punct">['</span><span class="string">candle</span><span class="punct">',</span> <span class="punct">'</span><span class="string">soup</span><span class="punct">',</span> <span class="punct">'</span><span class="string">mackarel</span><span class="punct">'].</span><span class="ident">join</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">candle * soup * mackarel</span><span class="punct">&quot;</span> 

 <span class="comment"># But, usually, you won't need the global variable.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">['</span><span class="string">candle</span><span class="punct">',</span> <span class="punct">'</span><span class="string">soup</span><span class="punct">',</span> <span class="punct">'</span><span class="string">mackarel</span><span class="punct">'].</span><span class="ident">join</span> <span class="punct">'</span><span class="string"> # </span><span class="punct">'</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">candle # soup # mackarel</span><span class="punct">&quot;</span> 

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$;</span>     <span class="comment"># The $; variable is the split separator, used when splitting strings</span>
   <span class="punct">=&gt;</span> <span class="constant">nil</span>    <span class="comment"># with String#split.</span>

 <span class="comment"># The split separator is normally empty, which means String#split will separate</span>
 <span class="comment"># the string where there is whitespace.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">candle  soup<span class="escape">\n</span>mackarel</span><span class="punct">&quot;.</span><span class="ident">split</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">candle</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">soup</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">mackarel</span><span class="punct">&quot;]</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$;</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">a</span><span class="punct">';</span> <span class="punct">&quot;</span><span class="string">candle  soup<span class="escape">\n</span>mackarel</span><span class="punct">&quot;.</span><span class="ident">split</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">c</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">ndle  soup<span class="escape">\n</span>m</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">ck</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">rel</span><span class="punct">&quot;]</span>

 <span class="comment"># But, usually, you won't need the global variable.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">candle # soup # mackarel</span><span class="punct">&quot;.</span><span class="ident">split</span> <span class="punct">'</span><span class="string"> # </span><span class="punct">'</span>
   <span class="punct">=&gt;</span> <span class="punct">['</span><span class="string">candle</span><span class="punct">',</span> <span class="punct">'</span><span class="string">soup</span><span class="punct">',</span> <span class="punct">'</span><span class="string">mackarel</span><span class="punct">']</span></code></pre></div>

	<p>Outside the <em>Gorilla Mint</em>, Blix scolded the foxes.  &#8220;We could have used that guy&#8217;s help!  If he knows where R.K. is, we could use his cunning!&#8221;</p>


	<p>&#8220;<strong>We don&#8217;t need that ape&#8217;s money!</strong>&#8221; said Fox Small.  &#8220;<strong>We can make our <em>own</em> money!</strong>&#8220;</p>


	<p>&#8220;<strong>We could support electronic wristbands!</strong>&#8221; said Fox Tall.</p>


	<p>&#8220;His money is worthless,&#8221; said Blix.  &#8220;It&#8217;s gorilla money.  It has no value.  It&#8217;s worse than blue crystals.&#8221;</p>


	<p>&#8220;But it serves a purpose,&#8221; said Fox Tall.</p>


	<p>&#8220;No it doesn&#8217;t,&#8221; said Fox Small.  &#8220;He just said it&#8217;s worthless.&#8221;</p>


	<p>&#8220;But what about linoleum and surgeries?&#8221; said Fox Tall.</p>


	<p>&#8220;Yeah,&#8221; said Fox Small, up at Blix.  &#8220;What about linoleum and surgeries?&#8221;</p>


	<p>&#8220;If all the hospitals were staffed by gorillas and all the home improvement chains were strictly operated by gorillas, then <del>- <span class="caps">YES</span> -</del> you could buy linoleum and surgeries.  But I <em>guarantee</em> that you would have very sloppy linoleum and very hideous surgeries.  I don&#8217;t think you&#8217;d make it out of that economy alive.&#8221;</p>


	<p>&#8220;So, if R.K. is so cunning,&#8221; said Fox Tall, grinning slyly, &#8220;why does he print such worthless currency?&#8221;</p>


	<p>&#8220;It&#8217;s a cover for other activities,&#8221; said Blix.  &#8220;Besides, if you&#8217;re so smart, why did you resort to violently pounding that poor gorilla?&#8221;</p>


	<p>&#8220;I guess that was a bad play,&#8221; said Fox Tall, hanging his head.  &#8220;My friend here will tell you that I&#8217;ve been on edge all day.&#8221;</p>


	<p>&#8220;And your rage finally reared its fuming snout!&#8221; said Fox Small.  &#8220;You&#8217;re finally living up to your goatee.&#8221;</p>


	<p><img src="../images/wixl-10.gif" alt="" /></p>


	<p>Down the lanes they travelled, the two foxes oblivious to their direction, but having a good time now that they had Blix leading the way with such urgency.  They lapsed into a careless wandering right behind Blix and spent their afternoon heckling most of the passersby.</p>


	<p>One such target of their ongoing commentary was The Winged Scroll Carriers, pairs of bats that carry documents which need to be immediately sworn and notarized.  There can be no delay, they must go swift, there is not even time to roll up the scroll, no, they must drop their swiss cheese and be out the door.</p>


	<p>These couriers resemble a kind of Ruby construct called <strong>delimited types</strong>.  A long series of characters comprises the scroll, flanked on each side by a bat bracing its curly wings to hold the scroll together. The opening bat wears a hat on which is written <code>%w</code>, which identifies the scroll as a set of words.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">bats</span> <span class="punct">=</span> <span class="punct">%w{</span><span class="string">The Winged Scroll Carriers</span><span class="punct">}</span>
   <span class="punct">=&gt;</span> <span class="punct">['</span><span class="string">The</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Winged</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Scroll</span><span class="punct">',</span> <span class="punct">'</span><span class="string">Carriers</span><span class="punct">']</span></code></pre></div>

	<p>The <code>%w</code> bats and their scroll, when fed into Ruby, emerge as an array of words.  This syntax is a shortcut in case you don&#8217;t want to go through the trouble of decorating each word with commas and quotes.  You are in a hurry, too, there can be no delay.  You jot out the words between the bats and let Ruby figure out where to cut.</p>


	<p>Other bats, other hats.  For instance, the <code>%x</code> hat runs an external program.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">%w{</span><span class="string">ruby --help</span><span class="punct">}</span>
   <span class="punct">=&gt;</span> <span class="punct">[&quot;</span><span class="string">ruby</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">--help</span><span class="punct">&quot;]</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">%x{</span><span class="string">ruby --help</span><span class="punct">}</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Usage: ruby [switches] [--] [programfile] [arguments] ...</span><span class="punct">&quot;</span></code></pre></div>

	<p>My favorite is the <code>%Q</code> hat, which can also be written as just <code>%</code>.  This acts just like a double-quoted string, but looks nice when used with strings that run-on for many lines.  Like, say you&#8217;re adding a new method with <code><span class="ident">eval</span></code>.</p>


<div class='example'><pre><code> <span class="ident">m</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">bats!</span><span class="punct">&quot;</span> 
 <span class="ident">eval</span> <span class="punct">%(</span><span class="string">
   def <span class="expr">#{ m }</span>
     puts &quot;{&quot; * 100
   end
 </span><span class="punct">)</span></code></pre></div>

	<p>Just like a double-quoted string, you can use the string interpolation lilypads inside.</p>


	<p><img src="../images/wixl-15.png" title="Cloneberries: The More You Eat, The More *You*." alt="Cloneberries: The More You Eat, The More *You*." /></p>


	<p>Blixy wagged his head.  &#8220;Oh, dear me.&#8221;</p>


	<p>&#8220;Egads! My hand is pregnant,&#8221; said Fox Tall, watching the little fox embryo slide about in his palm.</p>


	<p>&#8220;They are good berries, though,&#8221; said Blix.  &#8220;The wine they make from these berries will make ya grow a few eyeballs in your teeth.  But no more than that.&#8221;</p>


	<p>&#8220;Ah, pain!&#8221; yelled Fox Small, as his miniature squeezed out through the pores in his scalp.  But soon he was cradling his little self and murmuring lullablies.  <em>Nevermore, nevermore, sweetly sang the nightingale.  Winking starlight, sleeping still, whilst perched on a Sycamore stump.</em></p>


	<p>Making duplicates of Ruby objects is no more than a berry&#8217;s worth of code.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">tree</span> <span class="punct">=</span> <span class="punct">[</span><span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">]</span>
   <span class="punct">=&gt;</span> <span class="punct">[</span><span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">]</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">treechild</span> <span class="punct">=</span> <span class="ident">tree</span><span class="punct">.</span><span class="ident">clone</span>
   <span class="punct">=&gt;</span> <span class="punct">[</span><span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">]</span></code></pre></div>

	<p>The <code><span class="ident">clone</span></code> method makes an exact copy of a Ruby object.  How does this differ from regular assignment?</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">tree_charles_william_iii</span> <span class="punct">=</span> <span class="ident">tree</span>
   <span class="punct">=&gt;</span> <span class="punct">[</span><span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">]</span></code></pre></div>

	<p>Assigning object to variables only creates more nicknames.  The above Array can be called <code><span class="ident">tree_charles_william_iii</span></code> now.  Or the shorter <code><span class="ident">tree</span></code>.  The same object, but different names.</p>


	<p>However, a clone is a copy of an object.  You can modify it without affecting the original.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">treechild</span> <span class="punct">&lt;&lt;</span> <span class="punct">'</span><span class="string">flower</span><span class="punct">'</span>
   <span class="punct">=&gt;</span> <span class="punct">[</span><span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">,</span> <span class="punct">'</span><span class="string">flower</span><span class="punct">']</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">tree</span>
   <span class="punct">=&gt;</span> <span class="punct">[</span><span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">,</span> <span class="symbol">:berry</span><span class="punct">]</span></code></pre></div>

	<p>The <code><span class="ident">clone</span></code> method doesn&#8217;t make copies of everything attached to the object, though.  In the array above, only the array is copied, not all the symbols and strings inside.</p>


	<p>You may also see the <code><span class="ident">dup</span></code> method used to copy objects.  The <code><span class="ident">dup</span></code> method makes copies which aren&#8217;t as exact.  For example, there are objects in Ruby which are &#8220;frozen&#8221; and can&#8217;t be altered.  If you <code><span class="ident">clone</span></code> the object, you get an exact copy which is also frozen.  If you use <code><span class="ident">dup</span></code>, you get an unfrozen copy that you can change if you like.</p>


	<p>The <code><span class="ident">clone</span></code> method also copies the metaclass of an object, whereas <code><span class="ident">dup</span></code> does not.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">o</span> <span class="punct">=</span> <span class="constant">Object</span><span class="punct">.</span><span class="ident">new</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">class </span><span class="punct">&lt;&lt;</span> <span class="ident">o</span>
 <span class="ident">irb</span><span class="punct">&gt;</span>   <span class="keyword">def </span><span class="method">nevermore</span><span class="punct">;</span> <span class="symbol">:nevermore</span><span class="punct">;</span> <span class="keyword">end</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="keyword">end</span>

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">o</span><span class="punct">.</span><span class="ident">clone</span><span class="punct">.</span><span class="ident">nevermore</span>
   <span class="punct">=&gt;</span> <span class="symbol">:nevermore</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">o</span><span class="punct">.</span><span class="ident">dup</span><span class="punct">.</span><span class="ident">nevermore</span>
 <span class="comment"># NoMethodError: undefined method `nevermore' for #&lt;Object:0xb7d4a484&gt;</span>
 <span class="comment">#         from (irb):7</span></code></pre></div>

	<p>You don&#8217;t always need to make copies of objects, though, since many methods like <code><span class="ident">collect</span></code> and <code><span class="ident">gsub</span></code> and <code><span class="ident">format</span></code> make copies for you as part of their work.</p>


	<p><img src="../images/wixl-4.gif" title="Deer of the Smoky Pink Puffing." alt="Deer of the Smoky Pink Puffing." /></p>


	<p>Over the hills and down the valleys, they ran through the grass where the Deer of the Smoky Pink Puffing roam.  The sun was obscured by the lumbering pink clouds, emblazened with deer language, tinting the horizon a gradient of grapefruit and secreting a glow over the meadow.  The clouds slid past each other, some bobbing upwards, destined for Canadian relatives.  Others landing a readable distance from a recipient&#8217;s hooves.</p>


	<p>&#8220;Let&#8217;s stop!  <em>Please!</em>&#8221; yelled Fox Tall.  &#8220;You can&#8217;t expect us to run in this <strong>unbreathable fluff!</strong>&#8220;</p>


	<p>&#8220;Why are you yelling?&#8221; said Blix, as a thin stratus telegram wafted behind his legs.  &#8220;You don&#8217;t need to raise your voice above a whisper.  These long skinny clouds are usually just a mumble or a sigh.  They may not even make it all the way.&#8221;</p>

    
    
        
        <div class="sidebar">
        <h1>sidebar!</h1>
        
        <h2>Steaks &#8216;n&#8217; Slides</h2>
        

        <p>My uncles love waterslides and they also love steakhouses.  They have these waterslide days which are directly followed by a trip over to Joey&#8217;s Steakhouse.  I <em>hate</em> Joey&#8217;s Steakhouse.  It&#8217;s all big, brown shoe meat.  Floppy and galoshy.  Mixed with the stench of the uncles&#8217; chlorine.</p>


	<p>Pruny fingers on meat slabs is The Revolting.</p>


	<p>It&#8217;s time for steaks and waterslides to come together in a truly repugnant manner. My uncles have had steaks and waterslides their whole lives.  The dynasty of steaks and waterslides must come to a close.  I will marry them in ways against nature!</p>


	<p>Like this:</p>


	<ul>
	<li>Hand steaks to riders as they board the waterslide.  Rider looks at the lifeguard. Lifeguard says wait.  Rider looks again.  The lifeguard pauses.  Then.  Okay, it&#8217;s time. <em>Go, kid, go!</em>  And the look on that kid&#8217;s face as he rushes down the slope, paws full of chuck!  <em>Go, kid, go!</em></li>
		<li>Kids slide on top of steaks.  For safety, we&#8217;d want the slides stacked five steaks deep.</li>
		<li>Or, steaks do the sliding.  In their own little swim trunks.</li>
		<li>Or, people.  With steak swim trunks.</li>
		<li>People and steaks, side-by-side.</li>
		<li>Steaks travelling down waterslides composed of steaks.</li>
		<li>Steaks travelling down waterslides made of people.</li>
		<li>And, of course, people eating steaks, but their tongues come out as waterslides and they have to push the steaks up the waterslides.  Which is impossible and a lifeguard has to climb up the waterslide and manually insert the steak into the esophagus.</li>
		<li>Waterslides eating people and steaks eating people.</li>
		<li>Waterslides and steaks becoming friends after smelling people on each other&#8217;s breath.</li>
		<li>Or, steaks befriending waterslides, but waterslides not reciprocating.  Waterslides become increasingly despondent and detached, getting into bad crowds and sinking into political extremity.  Steaks make ankle bracelets out of people and leave them in the waterslides&#8217; trouser pockets, when the trousers are unattended.  They sneak out of the waterslide commune via a huge waterslide made of steak swim trunks.</li>
		<li>Or, like I said, people with steak swim trunks.</li>
	</ul>
        <h1>sidebar!</h1>
        </div>

    
    

        <p>&#8220;All that writing on the cloud is deer talk?&#8221; said Fox Small.</p>


	<p>&#8220;Help!  <em>Where are you guys?</em>&#8221;  The taller fox ducked through a stormy tirade comprised of thick, billowing smoke and sharp wisps.  He whirled in every direction, &#8220;Somebody yell if you&#8217;re there!&#8221;</p>


	<p>He searched for a fissure in the dense matter, combing forward with his hands.  The verbose, angry clouds responded by prodding him ahead, forcing him into tight corners in their brief pause between sentences.  He landed in a sinkhole and kept his head down as the cascades of smoke surged forward.</p>


	<p>&#8220;Yeah, deer can read this stuff,&#8221; said Blix.  &#8220;They just face their target and shoot it out of their nostrils.  I once heard of a guy who <strong>rode</strong> a stag&#8217;s love poem.&#8221;</p>


	<p>&#8220;No way,&#8221; said Fox Small.</p>


	<p>&#8220;Yep,&#8221; said Blix.  &#8220;And that guy was me.&#8221;  Blix reached over his shoulder and latched onto a spiral column of smoke that was twisting just above his head.  &#8220;You just have to know which clouds are wimpy and which clouds are grandiloquent.&#8221;  Blix let the cloud pull him along and when the cloud banked upwards, Blix loosed his grip and kept his feet moving slowly along the ground.  &#8220;See, here&#8217;s a good one, long like a broom handle.  A guy found one once and it was shaped <em>exactly</em> like a car: windshield, driver&#8217;s side airbag, power steering. Uncanny!&#8221;</p>


	<p>&#8220;<em>And that guy was&#8212;</em>&#8220;</p>


	<p><strong>&#8220;It was!&#8221;</strong>  And Blix climbed up atop the long icy cloud, with its dangling glyphs, and stood proudly, floating high above the small fox&#8217;s pointy shadow.</p>


	<p>&#8220;Oh, I could do that,&#8221; said Fox Small.  &#8220;Tall and I go jetskiing all the time.  <em>I&#8217;ve stood up on my jetski.</em>  It&#8217;s just like that.&#8221;</p>


	<p>Fox Tall dashed through a descending puff, shattering its sentence, which letters came unglued and littered the ground with scrambled words, but he had only succeeded in reaching the depressive portions of the deer correspondence, which manifested itself as a dank and opaque mist.</p>


	<p>Meanwhile, his smaller counterpart grabbed a narrow train of smoke that passed under his arm.  He was airborned and yelled, <strong>&#8220;Tallyho!&#8221;</strong>  But he held too tightly and the cloud evaporated under his arm and sent him back down with a short hop.</p>


	<p>Since you&#8217;re just beginning your use of Ruby, you may not fully grasp regular expressions (or <em>regexps</em>) at first.  You may even find yourself clipping out regexps from the <a href="http://regexlib.com/DisplayPatterns.aspx">Regular Expression Library</a> and pasting them into your code without having the foggiest idea why the expression works.  Or <em>if</em> it works!</p>


<div class='example'><pre><code> <span class="ident">loop</span> <span class="keyword">do</span>
   <span class="ident">print</span> <span class="punct">&quot;</span><span class="string">Enter your password: </span><span class="punct">&quot;</span> 
   <span class="ident">password</span> <span class="punct">=</span> <span class="ident">gets</span>
   <span class="keyword">if</span> <span class="ident">password</span><span class="punct">.</span><span class="ident">match</span><span class="punct">(</span> <span class="punct">/</span><span class="regex">^<span class="escape">\w</span>{8,15}$</span><span class="punct">/</span> <span class="punct">)</span>
     <span class="keyword">break</span>
   <span class="keyword">else</span>
     <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">** Bad password! Must be 8 to 15 characters!</span><span class="punct">&quot;</span> 
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>Do you see the unreadable deer language in the example code?  The <code><span class="punct">/</span><span class="regex">^<span class="escape">\w</span>{8,15)$</span><span class="punct">/</span></code> is a regular expression.  If I may translate, the regexp is saying, <em>Please only allow letters, numbers or underscores.  No less than eight and no more than fifteen.</em></p>


	<p>Regular expressions are a mini-language built into Ruby and many other programming languages. I really shouldn&#8217;t say <em>mini</em>, though, since regexps can be twisted and complicated and much more difficult than any Ruby program.</p>


	<p>Using regular expressions is extremely simple.  It is like the Deer: making the smoke is an arduous process.  But hooking your elbow around the smoke and driving it to the Weinerschnitzel to get mustard pretzel dogs is easy.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">good_password</span><span class="punct">&quot;.</span><span class="ident">match</span><span class="punct">(</span> <span class="punct">/</span><span class="regex">^<span class="escape">\w</span>{8,15}$</span><span class="punct">/</span> <span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="comment">#&lt;MatchData:0xb7d54218&gt;</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">this_bad_password_too_long</span><span class="punct">&quot;.</span><span class="ident">match</span><span class="punct">(</span> <span class="punct">/</span><span class="regex">^<span class="escape">\w</span>{8,15}$</span><span class="punct">/</span> <span class="punct">)</span>
   <span class="punct">=&gt;</span> <span class="constant">nil</span></code></pre></div>

	<p>The <code><span class="constant">String</span><span class="comment">#match</span></code> method is the <em>simplest practical use</em> of regexps.  The <code><span class="ident">match</span></code> method checks to see if the string meets the rules inside the regexp.  A regexp is only useful with strings, to test strings for a series of conditions.  If the conditions are met, a <code><span class="constant">MatchData</span></code> object is returned.  If not, you get <code><span class="constant">nil</span></code>.</p>


	<p>The most basic regular expressions are for <strong>performing searches</strong> inside strings.  Let&#8217;s say you&#8217;ve got a big file and you want to search it for a word or phrase.  Since a bit of time has passed, let&#8217;s search the Preeventualist&#8217;s Losing and Finding Registry again.</p>


<div class='example'><pre><code> <span class="ident">require</span> <span class="punct">'</span><span class="string">preeventualist</span><span class="punct">'</span>
 <span class="constant">PreEventualist</span><span class="punct">.</span><span class="ident">searchfound</span><span class="punct">(</span> <span class="punct">'</span><span class="string">truck</span><span class="punct">'</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">page</span><span class="punct">|</span>
   <span class="ident">page</span><span class="punct">.</span><span class="ident">each_line</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">line</span><span class="punct">|</span>
     <span class="ident">puts</span> <span class="ident">line</span> <span class="keyword">if</span> <span class="ident">line</span><span class="punct">.</span><span class="ident">match</span><span class="punct">(</span> <span class="punct">/</span><span class="regex">truck</span><span class="punct">/</span> <span class="punct">)</span>
   <span class="keyword">end</span>
 <span class="keyword">end</span></code></pre></div>

	<p>This isn&#8217;t too different from the code we used earlier to search for lines with the word &#8220;truck&#8221;.  Earlier we used <code><span class="ident">puts</span> <span class="ident">line</span> <span class="keyword">if</span> <span class="ident">line</span><span class="punct">['</span><span class="string">truck</span><span class="punct">']</span></code>, which is actually a simpler way of searching a string, if you&#8217;re just looking for a simple word.  The regexp <code><span class="punct">/</span><span class="regex">truck</span><span class="punct">/</span></code> is identical.  Find the word &#8220;truck&#8221;.  Anywhere in the string.</p>


	<p>Uhm, what if truck is capitalized.  <strong>Truck.</strong>  What then?</p>


<div class='example'><pre><code> <span class="ident">puts</span> <span class="ident">line</span> <span class="keyword">if</span> <span class="ident">line</span><span class="punct">.</span><span class="ident">match</span><span class="punct">(</span> <span class="punct">/</span><span class="regex">[Tt][Rr][Uu][Cc][Kk]</span><span class="punct">/</span><span class="ident">i</span> <span class="punct">)</span></code></pre></div>

	<p>The <strong>character classes</strong> are the sections surrounded by <strong>square brackets</strong>.  Each character class gives a list of characters which are valid matches for that spot.  (The first spot matches either an uppercase <code><span class="constant">T</span></code> or a lowercase <code><span class="ident">t</span></code>.  The second spot matches an <code><span class="constant">R</span></code> or an <code><span class="ident">r</span></code>.  And so on.)</p>


	<p>But a simpler way to write it is like this:</p>


<div class='example'><pre><code> <span class="ident">puts</span> <span class="ident">line</span> <span class="keyword">if</span> <span class="ident">line</span><span class="punct">.</span><span class="ident">match</span><span class="punct">(</span> <span class="punct">/</span><span class="regex">truck</span><span class="punct">/</span><span class="ident">i</span> <span class="punct">)</span></code></pre></div>

	<p>The letter <code><span class="ident">i</span></code> modifier at the end of the regexp indicates that the search is <strong>not case-sensitive</strong>.  It will match Truck.  And <span class="caps">TRUCK</span>.  And TrUcK.  And other ups and downs.</p>


	<p>Oh, and maybe you&#8217;re truck is a certain model number.  <span class="caps">A T</span>-1000.  Or a T-2000.  You can&#8217;t remember.  It&#8217;s a T <em>something</em> thousand.</p>


<div class='example'><pre><code> <span class="ident">puts</span> <span class="ident">line</span> <span class="keyword">if</span> <span class="ident">line</span><span class="punct">.</span><span class="ident">match</span><span class="punct">(</span> <span class="punct">/</span><span class="regex">T-<span class="escape">\d</span>000</span><span class="punct">/</span> <span class="punct">)</span></code></pre></div>

	<p>See, deer language.  The <code>\<span class="ident">d</span></code> represents a <strong>digit</strong>.  It&#8217;s a place holder in the regexp for any type of number.  The regexp will now match T-1000, T-2000, all the way up to T-9000.</p>


	<table>
		<tr>
			<td colspan="3"><strong>Character Classes</strong> </td>
		</tr>
		<tr>
			<td> <code>\<span class="ident">d</span></code> </td>
			<td> matches digits </td>
			<td> can also be written <code><span class="punct">[</span><span class="number">0</span><span class="punct">-</span><span class="number">9</span><span class="punct">]</span></code> </td>
		</tr>
		<tr>
			<td> <code>\<span class="ident">w</span></code> </td>
			<td> matches word characters (letters, numbers and the underscore) </td>
			<td> can also be written <code><span class="punct">[</span><span class="constant">A</span><span class="punct">-</span><span class="constant">Za</span><span class="punct">-</span><span class="ident">z0</span><span class="punct">-</span><span class="number">9_</span><span class="punct">]</span></code> </td>
		</tr>
		<tr>
			<td> <code>\<span class="ident">s</span></code> </td>
			<td> matches whitespace (spaces, tabs, carriage returns, line feeds) </td>
			<td> a.k.a. <code><span class="punct">[</span> \<span class="ident">t\r\n</span><span class="punct">]</span></code> </td>
		</tr>
		<tr>
			<td> <code>\<span class="constant">D</span></code> </td>
			<td> matches everything <em>but</em> digits </td>
			<td> a negated set <code><span class="punct">[^\</span><span class="ident">d</span><span class="punct">]</span></code> </td>
		</tr>
		<tr>
			<td> <code>\<span class="constant">W</span></code> </td>
			<td> matches everything <em>but</em> word chars </td>
			<td> just like <code><span class="punct">[^\</span><span class="ident">w</span><span class="punct">]</span></code> </td>
		</tr>
		<tr>
			<td> <code>\<span class="constant">S</span></code> </td>
			<td> matches everything <em>but</em> whitespace </td>
			<td> also <code><span class="punct">[^\</span><span class="ident">s</span><span class="punct">]</span></code> </td>
		</tr>
		<tr>
			<td> <code><span class="punct">.</span></code> </td>
			<td> the period matches <strong>everything</strong>. </td>
		</tr>
	</table>




	<p>Building a regexp involves chaining these placeholders together to express your search.  If you&#8217;re looking for a number, followed by whitespace: <code><span class="punct">/</span><span class="regex"><span class="escape">\d\s</span></span><span class="punct">/</span></code>.  If you&#8217;re looking for three numbers in a row: <code><span class="punct">/</span><span class="regex"><span class="escape">\d\d\d</span></span><span class="punct">/</span></code>.  <strong>The opening and closing slashes mark the beginning and end of the regexp.</strong></p>


	<p>A search for three numbers in a row can also be written as: <code><span class="punct">/</span><span class="regex"><span class="escape">\d</span>{3}</span><span class="punct">/</span></code>.  Immediately following a character class like <code>\<span class="ident">d</span></code>, you can use a quantifier symbol to mark how many times you want the character class to be repeat.</p>


	<table>
		<tr>
			<td colspan="3"><strong>Quantifiers</strong> </td>
		</tr>
		<tr>
			<td> <code><span class="punct">{</span><span class="ident">n</span><span class="punct">}</span></code> </td>
			<td> match exactly <em>n</em> times </td>
			<td> Precisely three numbers in a row is <code><span class="punct">/</span><span class="regex"><span class="escape">\d</span>{3}</span><span class="punct">/</span></code> </td>
		</tr>
		<tr>
			<td> <code><span class="punct">{</span><span class="ident">n</span><span class="punct">,}</span></code> </td>
			<td> matches <em>n_ times or _more</em> </td>
			<td> Three or more letters in a row is <code><span class="punct">/</span><span class="regex">[a-z]{3,}</span><span class="punct">/</span><span class="ident">i</span></code> </td>
		</tr>
		<tr>
			<td> <code><span class="punct">{</span><span class="ident">n</span><span class="punct">,</span><span class="ident">n2</span><span class="punct">}</span></code> </td>
			<td> matches at least <em>n_ times but no more than _n2</em> times </td>
			<td> So, <code><span class="punct">/</span><span class="regex">[<span class="escape">\d</span>,]{3,9}</span><span class="punct">/</span></code> matches between three and nine characters which are numbers or commas </td>
		</tr>
		<tr>
			<td> <code><span class="punct">*</span></code> </td>
			<td> the asterisk <code><span class="punct">*</span></code> is short for <code><span class="punct">{</span><span class="number">0</span><span class="punct">,}</span></code> </td>
			<td> To match a colon, followed by zero or more word characters: <code><span class="punct">/</span><span class="regex">:<span class="escape">\w</span>*</span><span class="punct">/</span></code> </td>
		</tr>
		<tr>
			<td> <code><span class="punct">+</span></code> </td>
			<td> the plus is short for <code><span class="punct">{</span><span class="number">1</span><span class="punct">,}</span></code> </td>
			<td> To match one or more minus or plus signs, use <code><span class="punct">/</span><span class="regex">[-+]+</span><span class="punct">/</span></code> </td>
		</tr>
		<tr>
			<td> <code><span class="punct">?</span></code> </td>
			<td> the question mark is short for <code><span class="punct">{</span><span class="number">0</span><span class="punct">,</span><span class="number">1</span><span class="punct">}</span></code> </td>
			<td> To match three numbers followed by an optional period: <code><span class="punct">/</span><span class="regex"><span class="escape">\d</span>{3}[.]?</span><span class="punct">/</span></code> </td>
		</tr>
	</table>




	<p>A really common regular expression is for matching phone numbers.  American phone numbers (including an area code) can be matched using the digit character class and the precise quantifiers.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">Call 909-375-4434</span><span class="punct">&quot;</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex"><span class="escape">\d</span>{3}-<span class="escape">\d</span>{3}-<span class="escape">\d</span>{4}</span><span class="punct">/</span>
   <span class="punct">=&gt;</span> <span class="number">5</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">The number is (909) 375-4434</span><span class="punct">&quot;</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">[(]<span class="escape">\d</span>{3}[)]<span class="escape">\s</span>*<span class="escape">\d</span>{3}-<span class="escape">\d</span>{4}</span><span class="punct">/</span>
   <span class="punct">=&gt;</span> <span class="number">14</span></code></pre></div>

	<p>This time, instead of using <code><span class="ident">match</span></code> to search for the expression, the <code><span class="punct">=~</span></code> operator was used.  This operator is the <strong>match operator</strong>, an equals sign followed by <strong>a tilde</strong>.  The tilde is like a bit of smoke coming off the edge of a smokestack.  Remember the deer, the smoke they blow, a cryptic language just like regular expressions.  The smoky tilde points toward the regexp.</p>


	<p>The match operator returns a number.  The number is the spot in the string where the regular expression matched. So when the match operator returns <code><span class="number">5</span></code>, it&#8217;s saying, &#8220;Before the match, there are five characters in the string.&#8221;</p>


	<p>If you need to get the full string matched, you can use the special <code><span class="global">$&amp;</span></code> global variable if you&#8217;re using the match operator.  Or, if you&#8217;re using the <code><span class="ident">match</span></code> method, you can get the full string by converting the <code><span class="constant">MatchData</span></code> object to a string.</p>


<div class='example'><pre><code> <span class="comment"># Using =~ and $&amp; together.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="punct">&quot;</span><span class="string">The number is (909) 375-4434</span><span class="punct">&quot;</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">[(]<span class="escape">\d</span>{3}[)]<span class="escape">\s</span>*<span class="escape">\d</span>{3}-<span class="escape">\d</span>{4}</span><span class="punct">/</span>
   <span class="punct">=&gt;</span> <span class="number">14</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="global">$&amp;</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">(909) 375-4434</span><span class="punct">&quot;</span> 

 <span class="comment"># Using the MatchData object.</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">phone</span> <span class="punct">=</span> <span class="punct">/</span><span class="regex">[(]<span class="escape">\d</span>{3}[)]<span class="escape">\s</span>*<span class="escape">\d</span>{3}-<span class="escape">\d</span>{4}</span><span class="punct">/.</span><span class="ident">match</span><span class="punct">(&quot;</span><span class="string">The number is (909) 375-4434</span><span class="punct">&quot;)</span>     
   <span class="punct">=&gt;</span> <span class="comment">#&lt;MatchData:0xb7d51680&gt;</span>
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">phone</span><span class="punct">.</span><span class="ident">to_s</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">(909) 375-4434</span><span class="punct">&quot;</span></code></pre></div>

	<p>Most Rubyists prefer the second approach, as it uses an object within a <em>local variable</em> rather than a <em>global variable</em>. Global variables are kind of sketchy, since they can be easily overwritten.  If you run two regular expressions in a row, the global variable gets overwritten the second time.  But with local variables, you can keep both matches around as long as the variables are named differently.</p>


	<p>Other than matching, another common use of regular expression is to do <strong>search-and-replace</strong> from within Ruby. You can search for the word &#8220;cat&#8221; and replace it with the word &#8220;banjo.&#8221;  Sure, you can do that with strings or regexps.</p>


<div class='example'><pre><code> <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">song</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">I swiped your cat / And I stole your cathodes</span><span class="punct">&quot;</span> 
 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">song</span><span class="punct">.</span><span class="ident">gsub</span> <span class="punct">'</span><span class="string">cat</span><span class="punct">',</span> <span class="punct">'</span><span class="string">banjo</span><span class="punct">'</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">I swiped your banjo / And I stole your banjohodes</span><span class="punct">&quot;</span> 

 <span class="ident">irb</span><span class="punct">&gt;</span> <span class="ident">song</span><span class="punct">.</span><span class="ident">gsub</span> <span class="punct">/\</span><span class="ident">bcat\b</span><span class="punct">/,</span> <span class="punct">'</span><span class="string">banjo</span><span class="punct">'</span>
   <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">I swiped your banjo / And I stole your cathodes</span><span class="punct">&quot;</span></code></pre></div>

	<p>The <code><span class="ident">gsub</span></code> method is named for &#8220;global substitution.&#8221;  Notice how in the first example it replaced the word &#8220;cat&#8221; and the first three letters of &#8220;cathodes.&#8221;  Strings also have a simple <code><span class="ident">sub</span></code> method which will substite only once.</p>


	<p>And so this chapter ends, with Blix and the Foxes cruising aloft the solid pink belched from a very outspoken deer somewhere in those pastures.</p>

    
    
        
        <a name="section6" />
        <h2>6. Just Stopping To Assure You That the Porcupine Hasn't Budged</h2>

        <p><img src="../images/porcupine-3.gif" title="The porcupine and his kite again." alt="The porcupine and his kite again." /></p>

    
    
        
        <a name="section7" />
        <h2>7. I'm Out</h2>

        <p style="float:right"><img src="../images/quil-1.png" alt="" /></p>


	<p style="float:left"><img src="../images/quil-2.png" alt="" /></p>


	<p>One day, back around the time I met Bigelow (that dog who walked off with the balloons), I came back to my apartment hauling some board games I&#8217;d bought at a garage sale.  And Quil was on my porch.  Which stunned me since she&#8217;d been in San Antonio for like three years.  She was sleeping in a sleeping bag on my porch.</p>


	<p>She had run out of money to go to art school, so she stayed at my place for five months or so.</p>


	<p>I found this used bunkbed for our place.  At night we&#8217;d sit in our beds and read each other stories  from our notebooks.  I was writing a book about a kid who&#8217;s a detective and he&#8217;s trying to figure out who killed this kid on his tennis team and all these animals end up helping him figure it out.  She was writing a book about this kid who puts an ad in the classifieds to get other kids to join his made-up cult and they end up building a rocket ship.  But during most of her book these kids are lost in the woods and pretty directionless, which I got a kick out of hearing each night.</p>


	<p>Yeah, each night it was poetry or stories or ideas for tricking our neighbors.  Our neighbor Justin was a big fan of Warhammer and he had all these real swords and tunics.  We decided to make suits of armor out of tin foil and go attack his apartment.  We started ransacking his apartment and he loved it.  So he made his own suit of armor out of tin foil and we all went to a professional glamour studio and had a quality group shot taken.</p>


	<p style="float:right"><img src="../images/quil-3.png" alt="" /></p>


	<p>I&#8217;m not saying my life is any better than yours.  I just miss my sister.  Life isn&#8217;t like that now. We&#8217;re dissolved or something.</p>


	<p>I don&#8217;t know.  I&#8217;m confused.  Is this growing up?  Watching all your feathers come off?  And even though some of those feathers were the most lovely things?</p>


	<p>I&#8217;m having a hard time telling who stopped it all up.  Who stopped loving who?  Did I stop caring?  Maybe I only saw her in two-dimensions and I didn&#8217;t care to look at the other angles.  I only saw planes.  Then she shimmied up the z-axis when I wasn&#8217;t looking and I never did the homework to trace the coordinates.  A limb on a geometrical tree and I am insisting on circles.</p>


	<p>Blix was right.  I&#8217;m in so shape to write this book.  Goodbye until I can shake this.</p>


	<p><img src="../images/departure.png" alt="" /></p>

    
    

        <p style="text-align:right;">
        <a href="chapter-7.html">Turn page.</a>
        </p>

    </div>
</div>
</div>
</body>
</html>
